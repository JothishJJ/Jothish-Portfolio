{"version":3,"file":"MenuGroup.mjs","sources":["../../src/ui-components/confirmPopover/ConfirmPopover.tsx","../../src/ui-components/menuGroup/MenuGroup.tsx"],"sourcesContent":["/* eslint-disable no-restricted-imports, @sanity/i18n/no-i18next-import */\nimport {\n  Box,\n  Button as UIButton,\n  Flex,\n  Grid,\n  Popover as UIPopover,\n  type PopoverProps as UIPopoverProps,\n  Text,\n  useClickOutsideEvent,\n  useGlobalKeyDown,\n  useLayer,\n} from '@sanity/ui'\nimport {type ComponentType, type ReactNode, useCallback, useRef} from 'react'\nimport {useTranslation} from 'react-i18next'\n\nexport interface ConfirmPopoverProps {\n  cancelButtonIcon?: ReactNode | ComponentType\n  cancelButtonText?: string\n  confirmButtonIcon?: ReactNode | ComponentType\n  confirmButtonText?: string\n  message: ReactNode\n  onCancel: () => void\n  onConfirm: () => void\n  open: boolean\n  referenceElement: HTMLElement | null\n  tone?: 'default' | 'primary' | 'positive' | 'caution' | 'critical' | 'neutral' | 'suggest'\n  placement?: UIPopoverProps['placement']\n  fallbackPlacements?: UIPopoverProps['fallbackPlacements']\n}\n\n/**\n * A popover component for inline confirmation dialogs.\n * Follows the same pattern as document action confirm dialogs.\n *\n * @internal\n */\nexport function ConfirmPopover({\n  cancelButtonIcon,\n  cancelButtonText,\n  confirmButtonIcon,\n  confirmButtonText,\n  message,\n  onCancel,\n  onConfirm,\n  open,\n  referenceElement,\n  tone = 'critical',\n  placement = 'top',\n  fallbackPlacements = ['left', 'bottom'],\n}: ConfirmPopoverProps) {\n  if (!open) return null\n\n  return (\n    <UIPopover\n      content={\n        <ConfirmPopoverContent\n          cancelButtonIcon={cancelButtonIcon}\n          cancelButtonText={cancelButtonText}\n          confirmButtonIcon={confirmButtonIcon}\n          confirmButtonText={confirmButtonText}\n          message={message}\n          onCancel={onCancel}\n          onConfirm={onConfirm}\n          tone={tone}\n        />\n      }\n      constrainSize\n      fallbackPlacements={fallbackPlacements}\n      open\n      placement={placement}\n      portal\n      preventOverflow\n      referenceElement={referenceElement}\n    />\n  )\n}\n\nfunction ConfirmPopoverContent({\n  cancelButtonIcon,\n  cancelButtonText,\n  confirmButtonIcon,\n  confirmButtonText,\n  message,\n  onCancel,\n  onConfirm,\n  tone,\n}: Omit<ConfirmPopoverProps, 'open' | 'referenceElement' | 'placement' | 'fallbackPlacements'>) {\n  const {t} = useTranslation()\n  const {isTopLayer} = useLayer()\n  const ref = useRef<HTMLDivElement | null>(null)\n\n  const handleGlobalKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isTopLayer) onCancel()\n    },\n    [isTopLayer, onCancel],\n  )\n\n  useGlobalKeyDown(handleGlobalKeyDown)\n  useClickOutsideEvent(isTopLayer && onCancel, () => [ref.current])\n\n  return (\n    <Flex direction=\"column\" ref={ref} style={{minWidth: 280, maxWidth: 350}}>\n      <Box flex={1} overflow=\"auto\" padding={4}>\n        <Text size={1}>{message}</Text>\n      </Box>\n      <Box paddingX={4} paddingY={3} style={{borderTop: '1px solid var(--card-border-color)'}}>\n        <Grid columns={2} gap={2}>\n          <UIButton\n            data-testid=\"confirm-popover-cancel-button\"\n            icon={cancelButtonIcon}\n            onClick={onCancel}\n            mode=\"ghost\"\n            padding={2}\n            text={cancelButtonText || t('common.dialog.cancel-button.text')}\n            size={1}\n          />\n          <UIButton\n            data-testid=\"confirm-popover-confirm-button\"\n            icon={confirmButtonIcon}\n            onClick={onConfirm}\n            padding={2}\n            text={confirmButtonText || t('common.dialog.confirm-button.text')}\n            tone={tone}\n            size={1}\n          />\n        </Grid>\n      </Box>\n    </Flex>\n  )\n}\n","/* eslint-disable no-restricted-imports */\nimport {MenuGroup as UIMenuGroup, type MenuGroupProps as UIMenuGroupProps} from '@sanity/ui'\nimport {type HTMLProps, useCallback} from 'react'\n\nimport {\n  ConditionalWrapper,\n  type ConditionalWrapperRenderWrapperCallback,\n} from '../conditionalWrapper/ConditionalWrapper'\nimport {Tooltip, type TooltipProps} from '../tooltip/Tooltip'\n\n/** @internal */\nexport type MenuGroupProps = Pick<UIMenuGroupProps, 'icon' | 'popover' | 'text' | 'tone'>\n\n/**\n * Customized Sanity UI <MenuGroup> component with pre-defined layout options.\n *\n * @internal\n */\nexport const MenuGroup = (\n  props: MenuGroupProps &\n    Omit<HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref' | 'tabIndex' | 'popover'> & {\n      tooltipProps?: TooltipProps | null\n    },\n) => {\n  const {tooltipProps} = props\n\n  const renderWrapper = useCallback<ConditionalWrapperRenderWrapperCallback>(\n    (children) => {\n      return (\n        <Tooltip content={tooltipProps?.content} portal {...tooltipProps}>\n          {/* This div is needed to make the tooltip work in disabled menu items */}\n          <div>{children}</div>\n        </Tooltip>\n      )\n    },\n    [tooltipProps],\n  )\n\n  return (\n    <ConditionalWrapper condition={!!tooltipProps} wrapper={renderWrapper}>\n      <UIMenuGroup {...props} fontSize={1} padding={3} />\n    </ConditionalWrapper>\n  )\n}\n"],"names":["ConfirmPopover","t0","$","_c","cancelButtonIcon","cancelButtonText","confirmButtonIcon","confirmButtonText","message","onCancel","onConfirm","open","referenceElement","tone","t1","placement","t2","fallbackPlacements","t3","undefined","t4","t5","t6","UIPopover","ConfirmPopoverContent","t","useTranslation","isTopLayer","useLayer","ref","useRef","event","key","useGlobalKeyDown","Symbol","for","current","useClickOutsideEvent","minWidth","maxWidth","borderTop","t7","UIButton","t8","t9","t10","t11","MenuGroup","props","tooltipProps","children","content","renderWrapper","UIMenuGroup"],"mappings":"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"}