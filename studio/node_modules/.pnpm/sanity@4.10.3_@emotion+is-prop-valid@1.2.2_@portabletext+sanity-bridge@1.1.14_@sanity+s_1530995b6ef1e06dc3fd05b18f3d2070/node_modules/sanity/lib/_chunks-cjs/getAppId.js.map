{"version":3,"file":"getAppId.js","sources":["../../src/_internal/cli/util/getAppId.ts"],"sourcesContent":["import {type CliConfig} from '@sanity/cli'\nimport chalk from 'chalk'\n\ninterface Options {\n  cliConfig?: CliConfig\n  output?: {warn: (message: string) => void}\n}\n\n/**\n * Gets appId from sanity.cli.config.ts/js\n * @param options - Options\n * @returns boolean\n * @internal\n */\nexport function getAppId({cliConfig, output}: Options): string | undefined {\n  const hasOldCliConfigFlag =\n    cliConfig && 'app' in cliConfig && cliConfig.app && 'id' in cliConfig.app\n\n  const hasNewCliConfigFlag =\n    cliConfig &&\n    'deployment' in cliConfig &&\n    cliConfig.deployment &&\n    'appId' in cliConfig.deployment\n\n  if (hasOldCliConfigFlag && hasNewCliConfigFlag) {\n    throw new Error(\n      'Found both `app.id` (deprecated) and `deployment.appId` in sanity.cli.js. Please remove the deprecated `app.id`.',\n    )\n  }\n  const appId = hasOldCliConfigFlag ? cliConfig.app?.id : cliConfig?.deployment?.appId\n\n  if (hasOldCliConfigFlag) {\n    output?.warn(\n      chalk.yellow(\n        `The \\`app.id\\` config has moved to \\`deployment.appId\\`.\nPlease update \\`sanity.cli.ts\\` or \\`sanity.cli.js\\` and move:\n${chalk.red(`app: {id: \"${appId}\", ... }`)}\nto\n${chalk.green(`deployment: {appId: \"${appId}\", ... }`)})\n`,\n      ),\n    )\n  }\n  return appId\n}\n"],"names":["getAppId","cliConfig","output","hasOldCliConfigFlag","app","hasNewCliConfigFlag","deployment","Error","appId","id","warn","chalk","yellow","red","green"],"mappings":";;;;;;AAcO,SAASA,SAAS;AAAA,EAACC;AAAAA,EAAWC;AAAe,GAAuB;AACzE,QAAMC,sBACJF,aAAa,SAASA,aAAaA,UAAUG,OAAO,QAAQH,UAAUG,KAElEC,sBACJJ,aACA,gBAAgBA,aAChBA,UAAUK,cACV,WAAWL,UAAUK;AAEvB,MAAIH,uBAAuBE;AACzB,UAAM,IAAIE,MACR,kHACF;AAEF,QAAMC,QAAQL,sBAAsBF,UAAUG,KAAKK,KAAKR,WAAWK,YAAYE;AAE/E,SAAIL,uBACFD,QAAQQ,KACNC,eAAAA,QAAMC,OACJ;AAAA;AAAA,EAEND,eAAAA,QAAME,IAAI,cAAcL,KAAK,UAAU,CAAC;AAAA;AAAA,EAExCG,eAAAA,QAAMG,MAAM,wBAAwBN,KAAK,UAAU,CAAC;AAAA,CAEhD,CACF,GAEKA;AACT;;"}