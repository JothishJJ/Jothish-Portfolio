"use strict";var ea=Object.create;var Ae=Object.defineProperty;var ta=Object.getOwnPropertyDescriptor;var ra=Object.getOwnPropertyNames;var aa=Object.getPrototypeOf,ia=Object.prototype.hasOwnProperty;var ft=function(r,e){return function(){return r&&(e=r(r=0)),e}};var B=function(r,e){return function(){return e||r((e={exports:{}}).exports,e),e.exports}},na=function(r,e){for(var t in e)Ae(r,t,{get:e[t],enumerable:!0})},pt=function(r,e,t,i){if(e&&typeof e=="object"||typeof e=="function")for(var a=ra(e),n=0,o=a.length,s;n<o;n++)s=a[n],!ia.call(r,s)&&s!==t&&Ae(r,s,{get:function(u){return e[u]}.bind(null,s),enumerable:!(i=ta(e,s))||i.enumerable});return r};var G=function(r,e,t){return t=r!=null?ea(aa(r)):{},pt(e||!r||!r.__esModule?Ae(t,"default",{value:r,enumerable:!0}):t,r)},oa=function(r){return pt(Ae({},"__esModule",{value:!0}),r)};var Q=B(function(tn,yt){var xe;typeof window!="undefined"?xe=window:typeof global!="undefined"?xe=global:typeof self!="undefined"?xe=self:xe={};yt.exports=xe});function U(r,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](r):U(r,e)}var te=ft(function(){te()});function Ne(r){"@swc/helpers - typeof";return r&&typeof Symbol!="undefined"&&r.constructor===Symbol?"symbol":typeof r}var Qe=ft(function(){});var Ye=B(function(Ps,_r){var cr=Array.prototype.slice;_r.exports=Ca;function Ca(r,e){for(("length"in r)||(r=[r]),r=cr.call(r);r.length;){var t=r.shift(),i=e(t);if(i)return i;t.childNodes&&t.childNodes.length&&(r=cr.call(t.childNodes).concat(r))}}});var pr=B(function(Is,fr){te();fr.exports=ve;function ve(r,e){if(!U(this,ve))return new ve(r,e);this.data=r,this.nodeValue=r,this.length=r.length,this.ownerDocument=e||null}ve.prototype.nodeType=8;ve.prototype.nodeName="#comment";ve.prototype.toString=function(){return"[object Comment]"}});var vr=B(function(Ns,mr){te();mr.exports=ae;function ae(r,e){if(!U(this,ae))return new ae(r);this.data=r||"",this.length=this.data.length,this.ownerDocument=e||null}ae.prototype.type="DOMTextNode";ae.prototype.nodeType=3;ae.prototype.nodeName="#text";ae.prototype.toString=function(){return this.data};ae.prototype.replaceData=function(e,t,i){var a=this.data,n=a.substring(0,e),o=a.substring(e+t,a.length);this.data=n+i+o,this.length=this.data.length}});var Xe=B(function(Cs,hr){hr.exports=Ma;function Ma(r){var e=this,t=r.type;r.target||(r.target=e),e.listeners||(e.listeners={});var i=e.listeners[t];if(i)return i.forEach(function(a){r.currentTarget=e,typeof a=="function"?a(r):a.handleEvent(r)});e.parentNode&&e.parentNode.dispatchEvent(r)}});var $e=B(function(Ms,yr){yr.exports=Ha;function Ha(r,e){var t=this;t.listeners||(t.listeners={}),t.listeners[r]||(t.listeners[r]=[]),t.listeners[r].indexOf(e)===-1&&t.listeners[r].push(e)}});var Ze=B(function(Hs,gr){gr.exports=Ba;function Ba(r,e){var t=this;if(t.listeners&&t.listeners[r]){var i=t.listeners[r],a=i.indexOf(e);a!==-1&&i.splice(a,1)}}});var Er=B(function(Us,Tr){Qe();Tr.exports=br;var Ua=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function br(r){switch(r.nodeType){case 3:return et(r.data);case 8:return"<!--"+r.data+"-->";default:return Fa(r)}}function Fa(r){var e=[],t=r.tagName;return r.namespaceURI==="http://www.w3.org/1999/xhtml"&&(t=t.toLowerCase()),e.push("<"+t+Ga(r)+Wa(r)),Ua.indexOf(t)>-1?e.push(" />"):(e.push(">"),r.childNodes.length?e.push.apply(e,r.childNodes.map(br)):r.textContent||r.innerText?e.push(et(r.textContent||r.innerText)):r.innerHTML&&e.push(r.innerHTML),e.push("</"+t+">")),e.join("")}function Va(r,e){var t=Ne(r[e]);return e==="style"&&Object.keys(r.style).length>0?!0:r.hasOwnProperty(e)&&(t==="string"||t==="boolean"||t==="number")&&e!=="nodeName"&&e!=="className"&&e!=="tagName"&&e!=="textContent"&&e!=="innerText"&&e!=="namespaceURI"&&e!=="innerHTML"}function ja(r){if(typeof r=="string")return r;var e="";return Object.keys(r).forEach(function(t){var i=r[t];t=t.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}),e+=t+":"+i+";"}),e}function Wa(r){var e=r.dataset,t=[];for(var i in e)t.push({name:"data-"+i,value:e[i]});return t.length?wr(t):""}function wr(r){var e=[];return r.forEach(function(t){var i=t.name,a=t.value;i==="style"&&(a=ja(a)),e.push(i+'="'+Ja(a)+'"')}),e.length?" "+e.join(" "):""}function Ga(r){var e=[];for(var t in r)Va(r,t)&&e.push({name:t,value:r[t]});for(var i in r._attributes)for(var a in r._attributes[i]){var n=r._attributes[i][a],o=(n.prefix?n.prefix+":":"")+a;e.push({name:o,value:n.value})}return r.className&&e.push({name:"class",value:r.className}),e.length?wr(e):""}function et(r){var e="";return typeof r=="string"?e=r:r&&(e=r.toString()),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ja(r){return et(r).replace(/"/g,"&quot;")}});var rt=B(function(Vs,xr){te();var tt=Ye(),Qa=Xe(),za=$e(),Ka=Ze(),Ya=Er(),kr="http://www.w3.org/1999/xhtml";xr.exports=I;function I(r,e,t){if(!U(this,I))return new I(r);var i=t===void 0?kr:t||null;this.tagName=i===kr?String(r).toUpperCase():r,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=e||null,this.namespaceURI=i,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}I.prototype.type="DOMElement";I.prototype.nodeType=1;I.prototype.appendChild=function(e){return e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e),e.parentNode=this,e};I.prototype.replaceChild=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var i=this.childNodes.indexOf(t);return t.parentNode=null,this.childNodes[i]=e,e.parentNode=this,t};I.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return this.childNodes.splice(t,1),e.parentNode=null,e};I.prototype.insertBefore=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var i=t==null?-1:this.childNodes.indexOf(t);return i>-1?this.childNodes.splice(i,0,e):this.childNodes.push(e),e.parentNode=this,e};I.prototype.setAttributeNS=function(e,t,i){var a=null,n=t,o=t.indexOf(":");if(o>-1&&(a=t.substr(0,o),n=t.substr(o+1)),this.tagName==="INPUT"&&t==="type")this.type=i;else{var s=this._attributes[e]||(this._attributes[e]={});s[n]={value:i,prefix:a}}};I.prototype.getAttributeNS=function(e,t){var i=this._attributes[e],a=i&&i[t]&&i[t].value;return this.tagName==="INPUT"&&t==="type"?this.type:typeof a!="string"?null:a};I.prototype.removeAttributeNS=function(e,t){var i=this._attributes[e];i&&delete i[t]};I.prototype.hasAttributeNS=function(e,t){var i=this._attributes[e];return!!i&&t in i};I.prototype.setAttribute=function(e,t){return this.setAttributeNS(null,e,t)};I.prototype.getAttribute=function(e){return this.getAttributeNS(null,e)};I.prototype.removeAttribute=function(e){return this.removeAttributeNS(null,e)};I.prototype.hasAttribute=function(e){return this.hasAttributeNS(null,e)};I.prototype.removeEventListener=Ka;I.prototype.addEventListener=za;I.prototype.dispatchEvent=Qa;I.prototype.focus=function(){};I.prototype.toString=function(){return Ya(this)};I.prototype.getElementsByClassName=function(e){var t=e.split(" "),i=[];return tt(this,function(a){if(a.nodeType===1){var n=a.className||"",o=n.split(" ");t.every(function(s){return o.indexOf(s)!==-1})&&i.push(a)}}),i};I.prototype.getElementsByTagName=function(e){e=e.toLowerCase();var t=[];return tt(this.childNodes,function(i){i.nodeType===1&&(e==="*"||i.tagName.toLowerCase()===e)&&t.push(i)}),t};I.prototype.contains=function(e){return tt(this,function(t){return e===t})||!1}});var Sr=B(function(Ws,Dr){te();var at=rt();Dr.exports=K;function K(r){if(!U(this,K))return new K;this.childNodes=[],this.parentNode=null,this.ownerDocument=r||null}K.prototype.type="DocumentFragment";K.prototype.nodeType=11;K.prototype.nodeName="#document-fragment";K.prototype.appendChild=at.prototype.appendChild;K.prototype.replaceChild=at.prototype.replaceChild;K.prototype.removeChild=at.prototype.removeChild;K.prototype.toString=function(){return this.childNodes.map(function(e){return String(e)}).join("")}});var Rr=B(function(Gs,qr){qr.exports=it;function it(r){}it.prototype.initEvent=function(e,t,i){this.type=e,this.bubbles=t,this.cancelable=i};it.prototype.preventDefault=function(){}});var Pr=B(function(Qs,Ar){te();var Xa=Ye(),$a=pr(),Za=vr(),qe=rt(),ei=Sr(),ti=Rr(),ri=Xe(),ai=$e(),ii=Ze();Ar.exports=Ue;function Ue(){if(!U(this,Ue))return new Ue;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var j=Ue.prototype;j.createTextNode=function(e){return new Za(e,this)};j.createElementNS=function(e,t){var i=e===null?null:String(e);return new qe(t,this,i)};j.createElement=function(e){return new qe(e,this)};j.createDocumentFragment=function(){return new ei(this)};j.createEvent=function(e){return new ti(e)};j.createComment=function(e){return new $a(e,this)};j.getElementById=function(e){e=String(e);var t=Xa(this.childNodes,function(i){if(String(i.id)===e)return i});return t||null};j.getElementsByClassName=qe.prototype.getElementsByClassName;j.getElementsByTagName=qe.prototype.getElementsByTagName;j.contains=qe.prototype.contains;j.removeEventListener=ii;j.addEventListener=ai;j.dispatchEvent=ri});var Ir=B(function(zs,Or){var ni=Pr();Or.exports=new ni});var nt=B(function(Ks,Nr){var Lr=typeof global!="undefined"?global:typeof window!="undefined"?window:{},oi=Ir(),Re;typeof document!="undefined"?Re=document:(Re=Lr["__GLOBAL_DOCUMENT_CACHE@4"],Re||(Re=Lr["__GLOBAL_DOCUMENT_CACHE@4"]=oi));Nr.exports=Re});var Vi={};na(Vi,{default:function(){return Fi}});module.exports=oa(Vi);function mt(r){if(Array.isArray(r))return r}function vt(r,e){var t=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i=[],a=!0,n=!1,o,s;try{for(t=t.call(r);!(a=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));a=!0);}catch(u){n=!0,s=u}finally{try{!a&&t.return!=null&&t.return()}finally{if(n)throw s}}return i}}function ht(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ke(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function Pe(r,e){if(r){if(typeof r=="string")return ke(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ke(r,e)}}function H(r,e){return mt(r)||vt(r,e)||Pe(r,e)||ht()}var be=G(Q());var Je=G(Q());var gt=G(Q()),sa={now:function(){var r=gt.default.performance,e=r&&r.timing,t=e&&e.navigationStart,i=typeof t=="number"&&typeof r.now=="function"?t+r.now():Date.now();return Math.round(i)}},A=sa;var ee=function(){var e,t,i;if(typeof((e=Je.default.crypto)===null||e===void 0?void 0:e.getRandomValues)=="function"){i=new Uint8Array(32),Je.default.crypto.getRandomValues(i);for(var a=0;a<32;a++)i[a]=i[a]%16}else{i=[];for(var n=0;n<32;n++)i[n]=Math.random()*16|0}var o=0;t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var g=f==="x"?i[o]:i[o]&3|8;return o++,g.toString(16)});var s=A.now(),u=s==null?void 0:s.toString(16).substring(3);return u?t.substring(0,28)+u:t},Oe=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)};var J=function(e){if(e&&typeof e.nodeName!="undefined")return e.muxId||(e.muxId=Oe()),e.muxId;var t;try{t=document.querySelector(e)}catch(i){}return t&&!t.muxId&&(t.muxId=e),(t==null?void 0:t.muxId)||e},se=function(e){var t;e&&typeof e.nodeName!="undefined"?(t=e,e=J(t)):t=document.querySelector(e);var i=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,i]};function bt(r){if(Array.isArray(r))return ke(r)}function wt(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Tt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(r){return bt(r)||wt(r)||Pe(r)||Tt()}var Y={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},Et=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,i,a,n,o,s=r?[console,r]:[console],u=(t=console.trace).bind.apply(t,V(s)),f=(i=console.info).bind.apply(i,V(s)),g=(a=console.debug).bind.apply(a,V(s)),k=(n=console.warn).bind.apply(n,V(s)),h=(o=console.error).bind.apply(o,V(s)),c=e;return{trace:function(){for(var w=arguments.length,x=new Array(w),v=0;v<w;v++)x[v]=arguments[v];if(!(c>Y.TRACE))return u.apply(void 0,V(x))},debug:function(){for(var w=arguments.length,x=new Array(w),v=0;v<w;v++)x[v]=arguments[v];if(!(c>Y.DEBUG))return g.apply(void 0,V(x))},info:function(){for(var w=arguments.length,x=new Array(w),v=0;v<w;v++)x[v]=arguments[v];if(!(c>Y.INFO))return f.apply(void 0,V(x))},warn:function(){for(var w=arguments.length,x=new Array(w),v=0;v<w;v++)x[v]=arguments[v];if(!(c>Y.WARN))return k.apply(void 0,V(x))},error:function(){for(var w=arguments.length,x=new Array(w),v=0;v<w;v++)x[v]=arguments[v];if(!(c>Y.ERROR))return h.apply(void 0,V(x))},get level(){return c},set level(m){m!==this.level&&(c=m!=null?m:e)}}};var R=Et("[mux]");var Ie=G(Q());function ce(){var r=Ie.default.doNotTrack||Ie.default.navigator&&Ie.default.navigator.doNotTrack;return r==="1"}function b(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}te();function D(r,e){if(!U(r,e))throw new TypeError("Cannot call a class as a function")}function kt(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function N(r,e,t){return e&&kt(r.prototype,e),t&&kt(r,t),r}function l(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function X(r){return X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},X(r)}function xt(r,e){for(;!Object.prototype.hasOwnProperty.call(r,e)&&(r=X(r),r!==null););return r}function De(r,e,t){return typeof Reflect!="undefined"&&Reflect.get?De=Reflect.get:De=function(a,n,o){var s=xt(a,n);if(s){var u=Object.getOwnPropertyDescriptor(s,n);return u.get?u.get.call(o||a):u.value}},De(r,e,t||r)}function Le(r,e){return Le=Object.setPrototypeOf||function(i,a){return i.__proto__=a,i},Le(r,e)}function Dt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Le(r,e)}function St(r,e){if(r==null)return{};var t={},i=Object.keys(r),a,n;for(n=0;n<i.length;n++)a=i[n],!(e.indexOf(a)>=0)&&(t[a]=r[a]);return t}function qt(r,e){if(r==null)return{};var t=St(r,e),i,a;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(t[i]=r[i])}return t}function Rt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}Qe();function At(r,e){return e&&(Ne(e)==="object"||typeof e=="function")?e:b(r)}function Pt(r){var e=Rt();return function(){var i=X(r),a;if(e){var n=X(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return At(this,a)}}var F=function(r){return re(r)[0]};var re=function(r){if(typeof r!="string"||r==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=r.match(e)||[],i=t[4],a;return i&&(a=(i.match(/[^\.]+\.[^\.]+$/)||[])[0]),[i,a]};var Ce=G(Q()),ua={exists:function(){var r=Ce.default.performance,e=r&&r.timing;return e!==void 0},domContentLoadedEventEnd:function(){var r=Ce.default.performance,e=r&&r.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var r=Ce.default.performance,e=r&&r.timing;return e&&e.navigationStart}},_e=ua;function P(r,e,t){t=t===void 0?1:t,r[e]=r[e]||0,r[e]+=t}function ue(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){l(r,a,t[a])})}return r}function da(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function fe(r,e){return e=e!=null?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):da(Object(e)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r}var la=["x-cdn","content-type"],Ot=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],ca=la.concat(Ot);function pe(r){r=r||"";var e={},t=r.trim().split(/[\r\n]+/);return t.forEach(function(i){if(i){var a=i.split(": "),n=a.shift();n&&(ca.indexOf(n.toLowerCase())>=0||n.toLowerCase().indexOf("x-litix-")===0)&&(e[n]=a.join(": "))}}),e}function de(r){if(r){var e=Ot.find(function(t){return r[t]!==void 0});return e?r[e]:void 0}}var _a=function(r){var e={};for(var t in r){var i=r[t],a=i["DATA-ID"].search("io.litix.data.");if(a!==-1){var n=i["DATA-ID"].replace("io.litix.data.","");e[n]=i.VALUE}}return e},Me=_a;var He=function(r){if(!r)return{};var e=_e.navigationStart(),t=r.loading,i=t?t.start:r.trequest,a=t?t.first:r.tfirst,n=t?t.end:r.tload;return{bytesLoaded:r.total,requestStart:Math.round(e+i),responseStart:Math.round(e+a),responseEnd:Math.round(e+n)}},Se=function(r){if(!(!r||typeof r.getAllResponseHeaders!="function"))return pe(r.getAllResponseHeaders())},It=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,n=r.log,o=r.utils.secondsToMs,s=function(v){var p=parseInt(a.version),_;return p===1&&v.programDateTime!==null&&(_=v.programDateTime),p===0&&v.pdt!==null&&(_=v.pdt),_};if(!_e.exists()){n.warn("performance timing not supported. Not tracking HLS.js.");return}var u=function(v,p){return r.emit(e,v,p)},f=function(v,p){var _=p.levels,d=p.audioTracks,y=p.url,T=p.stats,E=p.networkDetails,S=p.sessionData,L={},M={};_.forEach(function(W,oe){L[oe]={width:W.width,height:W.height,bitrate:W.bitrate,attrs:W.attrs}}),d.forEach(function(W,oe){M[oe]={name:W.name,language:W.lang,bitrate:W.bitrate}});var O=He(T),q=O.bytesLoaded,Z=O.requestStart,we=O.responseStart,Te=O.responseEnd;u("requestcompleted",fe(ue({},Me(S)),{request_event_type:v,request_bytes_loaded:q,request_start:Z,request_response_start:we,request_response_end:Te,request_type:"manifest",request_hostname:F(y),request_response_headers:Se(E),request_rendition_lists:{media:L,audio:M,video:{}}}))};t.on(a.Events.MANIFEST_LOADED,f);var g=function(v,p){var _=p.details,d=p.level,y=p.networkDetails,T=p.stats,E=He(T),S=E.bytesLoaded,L=E.requestStart,M=E.responseStart,O=E.responseEnd,q=_.fragments[_.fragments.length-1],Z=s(q)+o(q.duration);u("requestcompleted",{request_event_type:v,request_bytes_loaded:S,request_start:L,request_response_start:M,request_response_end:O,request_current_level:d,request_type:"manifest",request_hostname:F(_.url),request_response_headers:Se(y),video_holdback:_.holdBack&&o(_.holdBack),video_part_holdback:_.partHoldBack&&o(_.partHoldBack),video_part_target_duration:_.partTarget&&o(_.partTarget),video_target_duration:_.targetduration&&o(_.targetduration),video_source_is_live:_.live,player_manifest_newest_program_time:isNaN(Z)?void 0:Z})};t.on(a.Events.LEVEL_LOADED,g);var k=function(v,p){var _=p.details,d=p.networkDetails,y=p.stats,T=He(y),E=T.bytesLoaded,S=T.requestStart,L=T.responseStart,M=T.responseEnd;u("requestcompleted",{request_event_type:v,request_bytes_loaded:E,request_start:S,request_response_start:L,request_response_end:M,request_type:"manifest",request_hostname:F(_.url),request_response_headers:Se(d)})};t.on(a.Events.AUDIO_TRACK_LOADED,k);var h=function(v,p){var _=p.stats,d=p.networkDetails,y=p.frag;_=_||y.stats;var T=He(_),E=T.bytesLoaded,S=T.requestStart,L=T.responseStart,M=T.responseEnd,O=d?Se(d):void 0,q={request_event_type:v,request_bytes_loaded:E,request_start:S,request_response_start:L,request_response_end:M,request_hostname:d?F(d.responseURL):void 0,request_id:O?de(O):void 0,request_response_headers:O,request_media_duration:y.duration,request_url:d==null?void 0:d.responseURL};y.type==="main"?(q.request_type="media",q.request_current_level=y.level,q.request_video_width=(t.levels[y.level]||{}).width,q.request_video_height=(t.levels[y.level]||{}).height,q.request_labeled_bitrate=(t.levels[y.level]||{}).bitrate):q.request_type=y.type,u("requestcompleted",q)};t.on(a.Events.FRAG_LOADED,h);var c=function(v,p){var _=p.frag,d=_.start,y=s(_),T={currentFragmentPDT:y,currentFragmentStart:o(d)};u("fragmentchange",T)};t.on(a.Events.FRAG_CHANGED,c);var m=function(v,p){var _=p.type,d=p.details,y=p.response,T=p.fatal,E=p.frag,S=p.networkDetails,L=(E==null?void 0:E.url)||p.url||"",M=S?Se(S):void 0;if((d===a.ErrorDetails.MANIFEST_LOAD_ERROR||d===a.ErrorDetails.MANIFEST_LOAD_TIMEOUT||d===a.ErrorDetails.FRAG_LOAD_ERROR||d===a.ErrorDetails.FRAG_LOAD_TIMEOUT||d===a.ErrorDetails.LEVEL_LOAD_ERROR||d===a.ErrorDetails.LEVEL_LOAD_TIMEOUT||d===a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||d===a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||d===a.ErrorDetails.SUBTITLE_LOAD_ERROR||d===a.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||d===a.ErrorDetails.KEY_LOAD_ERROR||d===a.ErrorDetails.KEY_LOAD_TIMEOUT)&&u("requestfailed",{request_error:d,request_url:L,request_hostname:F(L),request_id:M?de(M):void 0,request_type:d===a.ErrorDetails.FRAG_LOAD_ERROR||d===a.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":d===a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||d===a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":d===a.ErrorDetails.SUBTITLE_LOAD_ERROR||d===a.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":d===a.ErrorDetails.KEY_LOAD_ERROR||d===a.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:y==null?void 0:y.code,request_error_text:y==null?void 0:y.text}),T){var O,q="".concat(L?"url: ".concat(L,"\n"):"")+"".concat(y&&(y.code||y.text)?"response: ".concat(y.code,", ").concat(y.text,"\n"):"")+"".concat(p.reason?"failure reason: ".concat(p.reason,"\n"):"")+"".concat(p.level?"level: ".concat(p.level,"\n"):"")+"".concat(p.parent?"parent stream controller: ".concat(p.parent,"\n"):"")+"".concat(p.buffer?"buffer length: ".concat(p.buffer,"\n"):"")+"".concat(p.error?"error: ".concat(p.error,"\n"):"")+"".concat(p.event?"event: ".concat(p.event,"\n"):"")+"".concat(p.err?"error message: ".concat((O=p.err)===null||O===void 0?void 0:O.message,"\n"):"");u("error",{player_error_code:_,player_error_message:d,player_error_context:q})}};t.on(a.Events.ERROR,m);var w=function(v,p){var _=p.frag,d=_&&_._url||"";u("requestcanceled",{request_event_type:v,request_url:d,request_type:"media",request_hostname:F(d)})};t.on(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,w);var x=function(v,p){var _=p.level,d=t.levels[_];if(d&&d.attrs&&d.attrs.BANDWIDTH){var y=d.attrs.BANDWIDTH,T,E=parseFloat(d.attrs["FRAME-RATE"]);isNaN(E)||(T=E),y?u("renditionchange",{video_source_fps:T,video_source_bitrate:y,video_source_width:d.width,video_source_height:d.height,video_source_rendition_name:d.name,video_source_codec:d==null?void 0:d.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(a.Events.LEVEL_SWITCHED,x),t._stopMuxMonitor=function(){t.off(a.Events.MANIFEST_LOADED,f),t.off(a.Events.LEVEL_LOADED,g),t.off(a.Events.AUDIO_TRACK_LOADED,k),t.off(a.Events.FRAG_LOADED,h),t.off(a.Events.FRAG_CHANGED,c),t.off(a.Events.ERROR,m),t.off(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,w),t.off(a.Events.LEVEL_SWITCHED,x),t.off(a.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(a.Events.DESTROYING,t._stopMuxMonitor)},Lt=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()};var Nt=function(r,e){if(!r||!r.requestEndDate)return{};var t=F(r.url),i=r.url,a=r.bytesLoaded,n=new Date(r.requestStartDate).getTime(),o=new Date(r.firstByteDate).getTime(),s=new Date(r.requestEndDate).getTime(),u=isNaN(r.duration)?0:r.duration,f=typeof e.getMetricsFor=="function"?e.getMetricsFor(r.mediaType).HttpList:e.getDashMetrics().getHttpRequests(r.mediaType),g;f.length>0&&(g=pe(f[f.length-1]._responseHeaders||""));var k=g?de(g):void 0;return{requestStart:n,requestResponseStart:o,requestResponseEnd:s,requestBytesLoaded:a,requestResponseHeaders:g,requestMediaDuration:u,requestHostname:t,requestUrl:i,requestId:k}},fa=function(r,e){var t=e.getQualityFor(r),i=e.getCurrentTrackFor(r).bitrateList;return i?{currentLevel:t,renditionWidth:i[t].width||null,renditionHeight:i[t].height||null,renditionBitrate:i[t].bandwidth}:{}},pa=function(r){var e;return(e=r.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},ma=function(e){try{var t,i,a=(i=e.getVersion)===null||i===void 0||(t=i.call(e))===null||t===void 0?void 0:t.split(".").map(function(n){return parseInt(n)})[0];return a}catch(n){return!1}},Ct=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=r.log;if(!t||!t.on){a.warn("Invalid dash.js player reference. Monitoring blocked.");return}var n=ma(t),o=function(_,d){return r.emit(e,_,d)},s=function(_){var d=_.type,y=_.data,T=(y||{}).url;o("requestcompleted",{request_event_type:d,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:F(T),request_url:T})};t.on("manifestLoaded",s);var u={},f=function(_){if(typeof _.getRequests!="function")return null;var d=_.getRequests({state:"executed"});return d.length===0?null:d[d.length-1]},g=function(_){var d=_.type,y=_.fragmentModel,T=_.chunk,E=f(y);k({type:d,request:E,chunk:T})},k=function(_){var d=_.type,y=_.chunk,T=_.request,E=(y||{}).mediaInfo,S=E||{},L=S.type,M=S.bitrateList;M=M||[];var O={};M.forEach(function(Ee,z){O[z]={},O[z].width=Ee.width,O[z].height=Ee.height,O[z].bitrate=Ee.bandwidth,O[z].attrs={}}),L==="video"?u.video=O:L==="audio"?u.audio=O:u.media=O;var q=Nt(T,t),Z=q.requestStart,we=q.requestResponseStart,Te=q.requestResponseEnd,W=q.requestResponseHeaders,oe=q.requestMediaDuration,je=q.requestHostname,We=q.requestUrl,Ge=q.requestId;o("requestcompleted",{request_event_type:d,request_start:Z,request_response_start:we,request_response_end:Te,request_bytes_loaded:-1,request_type:L+"_init",request_response_headers:W,request_hostname:je,request_id:Ge,request_url:We,request_media_duration:oe,request_rendition_lists:u})};n>=4?t.on("initFragmentLoaded",k):t.on("initFragmentLoaded",g);var h=function(_){var d=_.type,y=_.fragmentModel,T=_.chunk,E=f(y);c({type:d,request:E,chunk:T})},c=function(_){var d=_.type,y=_.chunk,T=_.request,E=y||{},S=E.mediaInfo,L=E.start,M=S||{},O=M.type,q=Nt(T,t),Z=q.requestStart,we=q.requestResponseStart,Te=q.requestResponseEnd,W=q.requestBytesLoaded,oe=q.requestResponseHeaders,je=q.requestMediaDuration,We=q.requestHostname,Ge=q.requestUrl,Ee=q.requestId,z=fa(O,t),Yr=z.currentLevel,Xr=z.renditionWidth,$r=z.renditionHeight,Zr=z.renditionBitrate;o("requestcompleted",{request_event_type:d,request_start:Z,request_response_start:we,request_response_end:Te,request_bytes_loaded:W,request_type:O,request_response_headers:oe,request_hostname:We,request_id:Ee,request_url:Ge,request_media_start_time:L,request_media_duration:je,request_current_level:Yr,request_labeled_bitrate:Zr,request_video_width:Xr,request_video_height:$r})};n>=4?t.on("mediaFragmentLoaded",c):t.on("mediaFragmentLoaded",h);var m={video:void 0,audio:void 0,totalBitrate:void 0},w=function(){if(m.video&&typeof m.video.bitrate=="number"){if(!(m.video.width&&m.video.height)){a.warn("have bitrate info for video but missing width/height");return}var _=m.video.bitrate;if(m.audio&&typeof m.audio.bitrate=="number"&&(_+=m.audio.bitrate),_!==m.totalBitrate)return m.totalBitrate=_,{video_source_bitrate:_,video_source_height:m.video.height,video_source_width:m.video.width,video_source_codec:pa(m.video.codec)}}},x=function(_,d,y){if(typeof _.newQuality!="number"){a.warn("missing evt.newQuality in qualityChangeRendered event",_);return}var T=_.mediaType;if(T==="audio"||T==="video"){var E=t.getBitrateInfoListFor(T).find(function(L){var M=L.qualityIndex;return M===_.newQuality});if(!(E&&typeof E.bitrate=="number")){a.warn("missing bitrate info for ".concat(T));return}m[T]=fe(ue({},E),{codec:t.getCurrentTrackFor(T).codec});var S=w();S&&o("renditionchange",S)}};t.on("qualityChangeRendered",x);var v=function(_){var d=_.request,y=_.mediaType;d=d||{},o("requestcanceled",{request_event_type:d.type+"_"+d.action,request_url:d.url,request_type:y,request_hostname:F(d.url)})};t.on("fragmentLoadingAbandoned",v);var p=function(_){var d=_.error,y,T,E=(d==null||(y=d.data)===null||y===void 0?void 0:y.request)||{},S=(d==null||(T=d.data)===null||T===void 0?void 0:T.response)||{};(d==null?void 0:d.code)===27&&o("requestfailed",{request_error:E.type+"_"+E.action,request_url:E.url,request_hostname:F(E.url),request_type:E.mediaType,request_error_code:S.status,request_error_text:S.statusText});var L="".concat(E!=null&&E.url?"url: ".concat(E.url,"\n"):"")+"".concat(S!=null&&S.status||S!=null&&S.statusText?"response: ".concat(S==null?void 0:S.status,", ").concat(S==null?void 0:S.statusText,"\n"):"");o("error",{player_error_code:d==null?void 0:d.code,player_error_message:d==null?void 0:d.message,player_error_context:L})};t.on("error",p),t._stopMuxMonitor=function(){t.off("manifestLoaded",s),t.off("initFragmentLoaded",k),t.off("mediaFragmentLoaded",c),t.off("qualityChangeRendered",x),t.off("error",p),t.off("fragmentLoadingAbandoned",v),delete t._stopMuxMonitor}},Mt=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()};var Ht=0,va=function(){"use strict";function r(){D(this,r),l(this,"_listeners",void 0)}return N(r,[{key:"on",value:function(t,i,a){return i._eventEmitterGuid=i._eventEmitterGuid||++Ht,this._listeners=this._listeners||{},this._listeners[t]=this._listeners[t]||[],a&&(i=i.bind(a)),this._listeners[t].push(i),i}},{key:"off",value:function(t,i){var a=this._listeners&&this._listeners[t];a&&a.forEach(function(n,o){n._eventEmitterGuid===i._eventEmitterGuid&&a.splice(o,1)})}},{key:"one",value:function(t,i,a){var n=this;i._eventEmitterGuid=i._eventEmitterGuid||++Ht;var o=function(){n.off(t,o),i.apply(a||this,arguments)};o._eventEmitterGuid=i._eventEmitterGuid,this.on(t,o)}},{key:"emit",value:function(t,i){var a=this;if(this._listeners){i=i||{};var n=this._listeners["before"+t]||[],o=this._listeners["before*"]||[],s=this._listeners[t]||[],u=this._listeners["after"+t]||[],f=function(g,k){g=g.slice(),g.forEach(function(h){h.call(a,{type:t},k)})};f(n,i),f(o,i),f(s,i),f(u,i)}}}]),r}(),Bt=va;var Be=G(Q()),ha=function(){"use strict";function r(e){var t=this;D(this,r),l(this,"_playbackHeartbeatInterval",void 0),l(this,"_playheadShouldBeProgressing",void 0),l(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(i,a){t._playbackHeartbeatInterval!==null&&(Be.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:a.viewer_time}),t._playbackHeartbeatInterval=null)})}return N(r,[{key:"_startPlaybackHeartbeatInterval",value:function(){var t=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=Be.default.setInterval(function(){t.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(Be.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),r}(),Ut=ha;var ya=function r(e){"use strict";var t=this;D(this,r),l(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(i,a){try{var n=e.errorTranslator({player_error_code:a.player_error_code,player_error_message:a.player_error_message,player_error_context:a.player_error_context,player_error_severity:a.player_error_severity,player_error_business_exception:a.player_error_business_exception});n&&(e.data.player_error_code=n.player_error_code||a.player_error_code,e.data.player_error_message=n.player_error_message||a.player_error_message,e.data.player_error_context=n.player_error_context||a.player_error_context,e.data.player_error_severity=n.player_error_severity||a.player_error_severity,e.data.player_error_business_exception=n.player_error_business_exception||a.player_error_business_exception,t.viewErrored=!0)}catch(o){e.mux.log.warn("Exception in error translator callback.",o),t.viewErrored=!0}}),e.on("aftererror",function(){var i,a,n,o,s;(i=e.data)===null||i===void 0||delete i.player_error_code,(a=e.data)===null||a===void 0||delete a.player_error_message,(n=e.data)===null||n===void 0||delete n.player_error_context,(o=e.data)===null||o===void 0||delete o.player_error_severity,(s=e.data)===null||s===void 0||delete s.player_error_business_exception})},Ft=ya;var ga=function(){"use strict";function r(e){D(this,r),l(this,"_watchTimeTrackerLastCheckedTime",void 0),l(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return N(r,[{key:"_updateWatchTime",value:function(t,i){var a=i.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=a),P(this.pm.data,"view_watch_time",a-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=a}},{key:"_clearWatchTimeState",value:function(t,i){this._updateWatchTime(t,i),this._watchTimeTrackerLastCheckedTime=null}}]),r}(),Vt=ga;var ba=function(){"use strict";function r(e){var t=this;D(this,r),l(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),l(this,"_lastTime",void 0),l(this,"_isAdPlaying",void 0),l(this,"_callbackUpdatePlaybackTime",void 0),l(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=A.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null,e.on("viewinit",function(){t.pm.data.view_playing_time_ms_cumulative=0});var i=this._startPlaybackTimeTracking.bind(this);e.on("playing",i),e.on("adplaying",i),e.on("seeked",i),e.on("rebufferend",i);var a=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",a),e.on("seeking",a),e.on("rebufferstart",a),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=A.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return N(r,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this._lastTime=A.now(),this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var t=this.pm.data.player_playhead_time||0,i=A.now(),a=i-this._lastTime,n=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&t>this._playbackTimeTrackerLastPlayheadPosition?n=t-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(n=a),n>0&&n<=1e3&&P(this.pm.data,"view_content_playback_time",n),this._callbackUpdatePlaybackTime!==null&&a>0&&a<=1e3&&(this._isAdPlaying&&P(this.pm.data,"ad_playing_time_ms_cumulative",a),P(this.pm.data,"view_playing_time_ms_cumulative",a)),this._playbackTimeTrackerLastPlayheadPosition=t,this._lastTime=i}}]),r}(),jt=ba;var wa=function(){"use strict";function r(e){D(this,r),l(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return N(r,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position=="undefined"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(t,i){var a=this,n=function(){a.pm.currentFragmentPDT&&a.pm.currentFragmentStart&&(a.pm.data.player_program_time=a.pm.currentFragmentPDT+a.pm.data.player_playhead_time-a.pm.currentFragmentStart)};if(i&&i.player_playhead_time)this.pm.data.player_playhead_time=i.player_playhead_time,n(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var o=this.pm.getPlayheadTime();typeof o!="undefined"&&(this.pm.data.player_playhead_time=o,n(),this._updateMaxPlayheadPosition())}}}]),r}(),Wt=wa;var Gt=5*60*1e3,Ta=function r(e){"use strict";if(D(this,r),!e.disableRebufferTracking){var t,i=function(n,o){a(o),t=void 0},a=function(n){if(t){var o=n.viewer_time-t;P(e.data,"view_rebuffer_duration",o),t=n.viewer_time,e.data.view_rebuffer_duration>Gt&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(Gt,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(n,o){return a(o)}),e.on("rebufferstart",function(n,o){t||(P(e.data,"view_rebuffer_count",1),t=o.viewer_time,e.one("rebufferend",i))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",i)})}},Jt=Ta;var Ea=function(){"use strict";function r(e){var t=this;D(this,r),l(this,"_lastCheckedTime",void 0),l(this,"_lastPlayheadTime",void 0),l(this,"_lastPlayheadTimeUpdatedTime",void 0),l(this,"_rebuffering",void 0),l(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:A.now()})}))}return N(r,[{key:"_checkIfRebuffering",value:function(t,i){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(t,i);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(i.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(t,i,!0);return}var a=i.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&a>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=i.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(t){this._lastCheckedTime=t,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=t}},{key:"_cleanupRebufferTracker",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:i.viewer_time});else{if(this._lastCheckedTime===null)return;var n=this.pm.data.player_playhead_time-this._lastPlayheadTime,o=i.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&n>0&&o-n>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+o-n}))}a?this._prepareRebufferTrackerState(i.viewer_time):this._clearRebufferTrackerState()}}]),r}(),Qt=Ea;var ka=function(){"use strict";function r(e){var t=this;D(this,r),l(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var i=e.data,a=i.view_id;if(!i.view_program_changed){var n=function(o,s){var u=s.viewer_time;o.type==="playing"&&typeof e.data.view_time_to_first_frame=="undefined"?t.calculateTimeToFirstFrame(u||A.now(),a):o.type==="adplaying"&&(typeof e.data.view_time_to_first_frame=="undefined"||t._inPrerollPosition())&&t.calculateTimeToFirstFrame(u||A.now(),a)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return N(r,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(t,i){i===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:t}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.pm.pageLoadInitTime&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.pm.pageLoadInitTime))}}]),r}(),zt=ka;var xa=function r(e){"use strict";var t=this;D(this,r),l(this,"_lastPlayerHeight",void 0),l(this,"_lastPlayerWidth",void 0),l(this,"_lastPlayheadPosition",void 0),l(this,"_lastSourceHeight",void 0),l(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var i=["pause","rebufferstart","seeking","error","adbreakstart","hb","renditionchange","orientationchange","viewend","playbackmodechange"],a=["playing","hb","renditionchange","orientationchange","playbackmodechange"];i.forEach(function(n){e.on(n,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var o=e.data.player_playhead_time-t._lastPlayheadPosition;if(o<0){t._lastPlayheadPosition=-1;return}var s=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),u=Math.max(0,s-1),f=Math.max(0,1-s);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,u),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,f),P(e.data,"view_total_content_playback_time",o),P(e.data,"view_total_upscaling",u*o),P(e.data,"view_total_downscaling",f*o)}t._lastPlayheadPosition=-1})}),a.forEach(function(n){e.on(n,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},Kt=xa;var Da=2e3,Sa=function r(e){"use strict";var t=this;D(this,r),l(this,"isSeeking",void 0),this.isSeeking=!1;var i=-1,a=function(){var n=A.now(),o=(e.data.viewer_time||n)-(i||n);P(e.data,"view_seek_duration",o),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,o),t.isSeeking=!1,i=-1};e.on("seeking",function(n,o){if(Object.assign(e.data,o),t.isSeeking&&o.viewer_time-i<=Da){i=o.viewer_time;return}t.isSeeking&&a(),t.isSeeking=!0,i=o.viewer_time,P(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){a()}),e.on("viewend",function(){t.isSeeking&&(a(),e.send("seeked")),t.isSeeking=!1,i=-1})},Yt=Sa;var Xt=function(e,t){e.push(t),e.sort(function(i,a){return i.viewer_time-a.viewer_time})},qa=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],Ra=function(){"use strict";function r(e){var t=this;D(this,r),l(this,"_adHasPlayed",void 0),l(this,"_adRequests",void 0),l(this,"_adResponses",void 0),l(this,"_currentAdRequestNumber",void 0),l(this,"_currentAdResponseNumber",void 0),l(this,"_prerollPlayTime",void 0),l(this,"_wouldBeNewAdPlay",void 0),l(this,"isAdBreak",void 0),l(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),qa.forEach(function(a){return e.on(a,t._updateAdData.bind(t))});var i=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",i),e.on("playing",i),e.on("viewend",i),e.on("adrequest",function(a,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},n),Xt(t._adRequests,n),P(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||P(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(a,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},n),Xt(t._adResponses,n);var o=t.findAdRequest(n.ad_request_id);o&&P(e.data,"view_ad_request_time",Math.max(0,n.viewer_time-o.viewer_time))}),e.on("adplay",function(a,n){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,P(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,n.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,n.viewer_time-e.data.view_start)),t._prerollPlayTime=n.viewer_time)}),e.on("adplaying",function(a,n){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time=="undefined"&&typeof t._prerollPlayTime!="undefined"&&(e.data.view_preroll_load_time=n.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=n.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(a,n){t._wouldBeNewAdPlay||P(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(a,n){t._wouldBeNewAdPlay||P(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return N(r,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(t){for(var i=0;i<this._adRequests.length;i++)if(this._adRequests[i].ad_request_id===t)return this._adRequests[i]}},{key:"_updateAdData",value:function(t,i){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&i.ad_tag_url){var a=H(re(i.ad_tag_url),2),n=a[0],o=a[1];this.pm.data.view_preroll_ad_tag_domain=o,this.pm.data.view_preroll_ad_tag_hostname=n}if(!this.pm.data.view_preroll_ad_asset_hostname&&i.ad_asset_url){var s=H(re(i.ad_asset_url),2),u=s[0],f=s[1];this.pm.data.view_preroll_ad_asset_domain=f,this.pm.data.view_preroll_ad_asset_hostname=u}this.pm.data.ad_type="preroll"}this.pm.data.ad_asset_url=i==null?void 0:i.ad_asset_url,this.pm.data.ad_tag_url=i==null?void 0:i.ad_tag_url,this.pm.data.ad_creative_id=i==null?void 0:i.ad_creative_id,this.pm.data.ad_id=i==null?void 0:i.ad_id,this.pm.data.ad_universal_id=i==null?void 0:i.ad_universal_id,i!=null&&i.ad_type&&(this.pm.data.ad_type=i==null?void 0:i.ad_type)}}]),r}(),$t=Ra;var Aa=function r(e){"use strict";var t=this;D(this,r),l(this,"lastWallClockTime",void 0);var i=function(){t.lastWallClockTime=A.now(),e.on("before*",a)},a=function(n){var o=A.now(),s=t.lastWallClockTime;t.lastWallClockTime=o,o-s>3e4&&(e.emit("devicesleep",{viewer_time:s}),Object.assign(e.data,{viewer_time:s}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:o}),Object.assign(e.data,{viewer_time:o}),e.send("devicewake"))};e.one("playbackheartbeat",i),e.on("playbackheartbeatend",function(){e.off("before*",a),e.one("playbackheartbeat",i)})},Zt=Aa;var Fe=G(Q());var ze=function(r){return r()}(function(){var r=function(){for(var i=0,a={};i<arguments.length;i++){var n=arguments[i];for(var o in n)a[o]=n[o]}return a};function e(t){function i(a,n,o){var s;if(typeof document!="undefined"){if(arguments.length>1){if(o=r({path:"/"},i.defaults,o),typeof o.expires=="number"){var u=new Date;u.setMilliseconds(u.getMilliseconds()+o.expires*864e5),o.expires=u}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(w){}return t.write?n=t.write(n,a):n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),a=encodeURIComponent(String(a)),a=a.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),a=a.replace(/[\(\)]/g,escape),document.cookie=[a,"=",n,o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}a||(s={});for(var f=document.cookie?document.cookie.split("; "):[],g=/(%[0-9A-Z]{2})+/g,k=0;k<f.length;k++){var h=f[k].split("="),c=h.slice(1).join("=");c.charAt(0)==='"'&&(c=c.slice(1,-1));try{var m=h[0].replace(g,decodeURIComponent);if(c=t.read?t.read(c,m):t(c,m)||c.replace(g,decodeURIComponent),this.json)try{c=JSON.parse(c)}catch(w){}if(a===m){s=c;break}a||(s[m]=c)}catch(w){}}return s}}return i.set=i,i.get=function(a){return i.call(i,a)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(a,n){i(a,"",r(n,{expires:-1}))},i.withConverter=e,i}return e(function(){})});var er="muxData",Pa=function(r){return Object.entries(r).map(function(e){var t=H(e,2),i=t[0],a=t[1];return"".concat(i,"=").concat(a)}).join("&")},Oa=function(r){return r.split("&").reduce(function(e,t){var i=H(t.split("="),2),a=i[0],n=i[1],o=+n,s=n&&o==n?o:n;return e[a]=s,e},{})},tr=function(){var e;try{e=Oa(ze.get(er)||"")}catch(t){e={}}return e},rr=function(e){try{ze.set(er,Pa(e),{expires:365})}catch(t){}},ar=function(){var e=tr();return e.mux_viewer_id=e.mux_viewer_id||ee(),e.msn=e.msn||Math.random(),rr(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},ir=function(){var e=tr(),t=A.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=ee(),e.sst=t),e.sex=t+25*60*1e3,rr(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}};function Ke(r,e){var t=e.beaconCollectionDomain,i=e.beaconDomain;if(t)return"https://"+t;r=r||"inferred";var a=i||"litix.io";return r.match(/^[a-z0-9]+$/)?"https://"+r+"."+a:"https://img.litix.io/a.gif"}var nr=G(Q()),or=function(){var e;switch(sr()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},sr=function(){var e=nr.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};or.getConnectionFromAPI=sr;var ur=or;var Ia={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},La=lr(Ia),Na={ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cm:"cmcd",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cv:"cumulative",cx:"connection",cz:"context",da:"data",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mp:"mode",ms:"ms",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",pv:"previous",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},dr=lr(Na);function lr(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[r[t]]=t);return e}function me(r){var e={},t={};return Object.keys(r).forEach(function(i){var a=!1;if(r.hasOwnProperty(i)&&r[i]!==void 0){var n=i.split("_"),o=n[0],s=La[o];s||(R.info("Data key word `"+n[0]+"` not expected in "+i),s=o+"_"),n.splice(1).forEach(function(u){u==="url"&&(a=!0),dr[u]?s+=dr[u]:Number.isInteger(Number(u))?s+=u:(R.info("Data key word `"+u+"` not expected in "+i),s+="_"+u+"_")}),a?t[s]=r[i]:e[s]=r[i]}}),Object.assign(e,t)}var ie=G(Q()),Cr=G(nt());var si={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},ui=56*1024,di=["hb","requestcompleted","requestfailed","requestcanceled"],li="https://img.litix.io",$=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=e||li,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},si,t)};$.prototype.queueEvent=function(r,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||r==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};$.prototype.flushEvents=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(r&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};$.prototype.destroy=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,r?this._clearBeaconQueue():this.flushEvents(),ie.default.clearTimeout(this._sendTimeout)};$.prototype._clearBeaconQueue=function(){var r=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(r);r>0&&Object.assign(e[e.length-1],me({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);Mr(this._beaconUrl,t,!0,function(){})};$.prototype._sendBeaconQueue=function(){var r=this;if(this._postInFlight){this._resendAfterPost=!0;return}var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),i=A.now();Mr(this._beaconUrl,t,!1,function(a,n){n?(r._eventQueue=e.concat(r._eventQueue),r._failureCount+=1,R.info("Error sending beacon: "+n)):r._failureCount=0,r._roundTripTime=A.now()-i,r._postInFlight=!1,r._resendAfterPost&&(r._resendAfterPost=!1,r._eventQueue.length>0&&r._sendBeaconQueue())})};$.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var r=Math.pow(2,this._failureCount-1);return r=r*Math.random(),(1+r)*this._options.baseTimeBetweenBeacons};$.prototype._startBeaconSending=function(){var r=this;ie.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=ie.default.setTimeout(function(){r._eventQueue.length&&r._sendBeaconQueue(),r._startBeaconSending()},this._getNextBeaconTime()))};$.prototype._createPayload=function(r){var e=this,t={transmission_timestamp:Math.round(A.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var i,a,n,o=function(){i=JSON.stringify({metadata:t,events:a||r}),n=i.length/1024},s=function(){return n<=e._options.maxPayloadKBSize};return o(),s()||(R.info("Payload size is too big ("+n+" kb). Removing unnecessary events."),a=r.filter(function(u){return di.indexOf(u.e)===-1}),o()),s()||(R.info("Payload size still too big ("+n+" kb). Cropping fields.."),a.forEach(function(u){for(var f in u){var g=u[f],k=50*1024;typeof g=="string"&&g.length>k&&(u[f]=g.substring(0,k))}}),o()),i};var ci=typeof Cr.default.exitPictureInPicture=="function"?function(r){return r.length<=ui}:function(r){return!1},Mr=function(r,e,t,i){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(r,e)){i();return}if(ie.default.fetch){ie.default.fetch(r,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:ci(e)}).then(function(n){return i(null,n.ok?null:"Error")}).catch(function(n){return i(null,n)});return}if(ie.default.XMLHttpRequest){var a=new ie.default.XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===4)return i(null,a.status!==200?"error":void 0)},a.open("POST",r),a.setRequestHeader("Content-Type","text/plain"),a.send(e);return}i()},Hr=$;var _i=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception","view_playing_time_ms_cumulative","ad_playing_time_ms_cumulative"],fi=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],pi=["ad_id","ad_creative_id","ad_universal_id"],mi=["viewstart","error","ended","viewend"],vi=10*60*1e3,Br=function(){"use strict";function r(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};D(this,r);var a,n,o,s,u,f,g,k,h,c,m,w;l(this,"mux",void 0),l(this,"envKey",void 0),l(this,"options",void 0),l(this,"eventQueue",void 0),l(this,"sampleRate",void 0),l(this,"disableCookies",void 0),l(this,"respectDoNotTrack",void 0),l(this,"previousBeaconData",void 0),l(this,"lastEventTime",void 0),l(this,"rateLimited",void 0),l(this,"pageLevelData",void 0),l(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=i,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new Hr(Ke(this.envKey,this.options));var x;this.sampleRate=(x=this.options.sampleRate)!==null&&x!==void 0?x:1;var v;this.disableCookies=(v=this.options.disableCookies)!==null&&v!==void 0?v:!1;var p;this.respectDoNotTrack=(p=this.options.respectDoNotTrack)!==null&&p!==void 0?p:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(a=this.options.platform)===null||a===void 0?void 0:a.name,viewer_application_version:(n=this.options.platform)===null||n===void 0?void 0:n.version,viewer_application_engine:(o=this.options.platform)===null||o===void 0?void 0:o.layout,viewer_device_name:(s=this.options.platform)===null||s===void 0?void 0:s.product,viewer_device_category:"",viewer_device_manufacturer:(u=this.options.platform)===null||u===void 0?void 0:u.manufacturer,viewer_os_family:(g=this.options.platform)===null||g===void 0||(f=g.os)===null||f===void 0?void 0:f.family,viewer_os_architecture:(h=this.options.platform)===null||h===void 0||(k=h.os)===null||k===void 0?void 0:k.architecture,viewer_os_version:(m=this.options.platform)===null||m===void 0||(c=m.os)===null||c===void 0?void 0:c.version,viewer_connection_type:ur(),page_url:Fe.default===null||Fe.default===void 0||(w=Fe.default.location)===null||w===void 0?void 0:w.href},this.viewerData=this.disableCookies?{}:ar()}return N(r,[{key:"send",value:function(t,i){if(!(!t||!(i!=null&&i.view_id))){if(this.respectDoNotTrack&&ce())return R.info("Not sending `"+t+"` because Do Not Track is enabled");if(!i||typeof i!="object")return R.error("A data object was expected in send() but was not provided");var a=this.disableCookies?{}:ir(),n=fe(ue({},this.pageLevelData,i,a,this.viewerData),{event:t,env_key:this.envKey});n.user_id&&(n.viewer_user_id=n.user_id,delete n.user_id);var o,s=((o=n.mux_sample_number)!==null&&o!==void 0?o:0)>=this.sampleRate,u=this._deduplicateBeaconData(t,n),f=me(u);if(this.lastEventTime=this.mux.utils.now(),s)return R.info("Not sending event due to sample rate restriction",t,n,f);if(this.envKey||R.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",t,n,f),!this.rateLimited)if(R.info("Sending event",t,n,f),this.rateLimited=!this.eventQueue.queueEvent(t,f),this.mux.WINDOW_UNLOADING&&t==="viewend")this.eventQueue.destroy(!0);else{if(this.mux.WINDOW_HIDDEN&&t==="hb")this.eventQueue.flushEvents(!0);else if(mi.indexOf(t)>=0){if(t==="error"&&i.player_error_severity==="warning")return;this.eventQueue.flushEvents()}if(this.rateLimited)return n.event="eventrateexceeded",f=me(n),this.eventQueue.queueEvent(n.event,f),R.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(t,i){var a=this,n={},o=i.view_id;if(o==="-1"||t==="viewstart"||t==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=vi)n=ue({},i),o&&(this.previousBeaconData=n),o&&t==="viewend"&&(this.previousBeaconData=null);else{var s=t.indexOf("request")===0;Object.entries(i).forEach(function(u){var f=H(u,2),g=f[0],k=f[1];a.previousBeaconData&&(k!==a.previousBeaconData[g]||_i.indexOf(g)>-1||a.objectHasChanged(s,g,k,a.previousBeaconData[g])||a.eventRequiresKey(t,g))&&(n[g]=k,a.previousBeaconData[g]=k)})}return n}},{key:"objectHasChanged",value:function(t,i,a,n){return!t||i.indexOf("request_")!==0?!1:i==="request_response_headers"||typeof a!="object"||typeof n!="object"?!0:Object.keys(a||{}).length!==Object.keys(n||{}).length}},{key:"eventRequiresKey",value:function(t,i){return!!(t==="renditionchange"&&i.indexOf("video_source_")===0||pi.includes(i)&&fi.includes(t))}}]),r}();var hi=function r(e){"use strict";D(this,r);var t=0,i=0,a=0,n=0,o=0,s=0,u=0,f=function(h,c){var m=c.request_start,w=c.request_response_start,x=c.request_response_end,v=c.request_bytes_loaded;n++;var p,_;if(w?(p=w-(m!=null?m:0),_=(x!=null?x:0)-w):_=(x!=null?x:0)-(m!=null?m:0),_>0&&v&&v>0){var d=v/_*8e3;o++,i+=v,a+=_,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,d),e.data.view_average_request_throughput=i/a*8e3,e.data.view_request_count=n,p>0&&(t+=p,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,p),e.data.view_average_request_latency=t/o)}},g=function(h,c){n++,s++,e.data.view_request_count=n,e.data.view_request_failed_count=s},k=function(h,c){n++,u++,e.data.view_request_count=n,e.data.view_request_canceled_count=u};e.on("requestcompleted",f),e.on("requestfailed",g),e.on("requestcanceled",k)},Ur=hi;var yi=60*60*1e3,gi=function r(e){"use strict";var t=this;D(this,r),l(this,"_lastEventTime",void 0),e.on("before*",function(i,a){var n=a.viewer_time,o=A.now(),s=t._lastEventTime;if(t._lastEventTime=o,s&&o-s>yi){var u=Object.keys(e.data).reduce(function(g,k){return k.indexOf("video_")===0?Object.assign(g,l({},k,e.data[k])):g},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var f=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:n},u)),e.playbackHeartbeat._playheadShouldBeProgressing=f,e.playbackHeartbeat._playheadShouldBeProgressing&&i.type!=="play"&&i.type!=="adbreakstart"&&(e.emit("play",{viewer_time:n}),i.type!=="playing"&&e.emit("playing",{viewer_time:n}))}})},Fr=gi;var bi=function r(e){"use strict";D(this,r);var t=function(u){var f=wi(u),g=Ti(u);if(f!=null&&!Vr(f,n)&&o<=g){n=f,o=g;var k={video_cdn:f};e.emit("cdnchange",k)}},i=null,a=null,n=null,o=0;e.on("viewinit",function(){i=null,a=null,n=null,o=0}),e.on("beforecdnchange",function(s,u){var f=u==null?void 0:u.video_cdn;f&&(typeof u.video_previous_cdn=="undefined"||u.video_previous_cdn===null)&&(Vr(f,a)?u.video_previous_cdn=i!=null?i:void 0:(u.video_previous_cdn=a!=null?a:void 0,i=a,a=f))}),e.on("requestcompleted",function(s,u){t(u)})};function Vr(r,e){return(r==null?void 0:r.toLowerCase())===(e==null?void 0:e.toLowerCase())}function wi(r){var e;return r!=null&&r.request_type&&(r.request_type==="media"||r.request_type==="video")&&(!((e=r.request_response_headers)===null||e===void 0)&&e["x-cdn"])?r.request_response_headers["x-cdn"]:r!=null&&r.video_cdn?r.video_cdn:null}function Ti(r){return r!=null&&r.request_start?r.request_start:r!=null&&r.viewer_time?r.viewer_time:Date.now()}var jr=bi;var Ei=function(r){try{return JSON.parse(r),!0}catch(e){return!1}},ki=function r(e){"use strict";var t=this;D(this,r),l(this,"_emittingAutomaticEvent",!1),l(this,"_hasInitialized",!1),e.on("viewstart",function(){t._hasInitialized||(t._hasInitialized=!0,t._emittingAutomaticEvent=!0,e.emit("playbackmodechange",{player_playback_mode:"standard",player_playback_mode_data:"{}"}),t._emittingAutomaticEvent=!1)}),e.on("viewend",function(){t._hasInitialized=!1}),e.on("playbackmodechange",function(i,a){t._emittingAutomaticEvent||(a.player_playback_mode_data?Ei(a.player_playback_mode_data)||(e.mux.log.warn("Invalid JSON string for player_playback_mode_data"),a.player_playback_mode_data="{}"):a.player_playback_mode_data="{}",e.data.player_playback_mode_data=a.player_playback_mode_data,e.data.player_playback_mode=a.player_playback_mode)})},Wr=ki;var xi=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange","cdnchange","playbackmodechange"],Di=new Set(["requestcompleted","requestfailed","requestcanceled"]),Si=function(r){"use strict";Dt(t,r);var e=Pt(t);function t(i,a,n){D(this,t);var o;o=e.call(this),l(b(o),"pageLoadEndTime",void 0),l(b(o),"pageLoadInitTime",void 0),l(b(o),"_destroyed",void 0),l(b(o),"_heartBeatTimeout",void 0),l(b(o),"adTracker",void 0),l(b(o),"dashjs",void 0),l(b(o),"data",void 0),l(b(o),"disablePlayheadRebufferTracking",void 0),l(b(o),"disableRebufferTracking",void 0),l(b(o),"errorTracker",void 0),l(b(o),"errorTranslator",void 0),l(b(o),"emitTranslator",void 0),l(b(o),"getAdData",void 0),l(b(o),"getPlayheadTime",void 0),l(b(o),"getStateData",void 0),l(b(o),"stateDataTranslator",void 0),l(b(o),"hlsjs",void 0),l(b(o),"id",void 0),l(b(o),"longResumeTracker",void 0),l(b(o),"minimumRebufferDuration",void 0),l(b(o),"mux",void 0),l(b(o),"playbackEventDispatcher",void 0),l(b(o),"playbackHeartbeat",void 0),l(b(o),"playbackHeartbeatTime",void 0),l(b(o),"playheadTime",void 0),l(b(o),"seekingTracker",void 0),l(b(o),"sustainedRebufferThreshold",void 0),l(b(o),"watchTimeTracker",void 0),l(b(o),"currentFragmentPDT",void 0),l(b(o),"currentFragmentStart",void 0),o.pageLoadInitTime=_e.navigationStart(),o.pageLoadEndTime=_e.domContentLoadedEventEnd();var s={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(h){return h},emitTranslator:function(){for(var h=arguments.length,c=new Array(h),m=0;m<h;m++)c[m]=arguments[m];return c},stateDataTranslator:function(h){return h}};o.mux=i,o.id=a,n!=null&&n.beaconDomain&&o.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),n=Object.assign(s,n),n.data=n.data||{},n.data.property_key&&(n.data.env_key=n.data.property_key,delete n.data.property_key),R.level=n.debug?Y.DEBUG:Y.WARN,o.getPlayheadTime=n.getPlayheadTime,o.getStateData=n.getStateData||function(){return{}},o.getAdData=n.getAdData||function(){},o.minimumRebufferDuration=n.minimumRebufferDuration,o.sustainedRebufferThreshold=n.sustainedRebufferThreshold,o.playbackHeartbeatTime=n.playbackHeartbeatTime,o.disableRebufferTracking=n.disableRebufferTracking,o.disableRebufferTracking&&o.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),o.disablePlayheadRebufferTracking=n.disablePlayheadRebufferTracking,o.errorTranslator=n.errorTranslator,o.emitTranslator=n.emitTranslator,o.stateDataTranslator=n.stateDataTranslator,o.playbackEventDispatcher=new Br(i,n.data.env_key,n),o.data={player_instance_id:ee(),mux_sample_rate:n.sampleRate,beacon_domain:n.beaconCollectionDomain||n.beaconDomain},o.data.view_sequence_number=1,o.data.player_sequence_number=1;var u=function(){typeof this.data.view_start=="undefined"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(b(o));if(o.on("viewinit",function(h,c){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,c),this._initializeViewData(),this.one("play",u),this.one("adbreakstart",u)}),o.on("videochange",function(h,c){this._resetView(c)}),o.on("programchange",function(h,c){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(c,{view_program_changed:!0})),u(),this.emit("play"),this.emit("playing")}),o.on("fragmentchange",function(h,c){this.currentFragmentPDT=c.currentFragmentPDT,this.currentFragmentStart=c.currentFragmentStart}),o.on("destroy",o.destroy),typeof window!="undefined"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var f=function(){var h=typeof o.data.view_start!="undefined";o.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",h&&o.mux.WINDOW_HIDDEN&&(o.data.player_is_paused||o.emit("hb"))};window.addEventListener("visibilitychange",f,!1);var g=function(h){h.persisted||o.destroy()};window.addEventListener("pagehide",g,!1),o.on("destroy",function(){window.removeEventListener("visibilitychange",f),window.removeEventListener("pagehide",g)})}o.on("playerready",function(h,c){Object.assign(this.data,c)}),xi.forEach(function(h){o.on(h,function(c,m){h.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,m),this._sanitizeData()}),o.on("after"+h,function(){(h!=="error"||this.errorTracker.viewErrored)&&this.send(h)})}),o.on("viewend",function(h,c){Object.assign(o.data,c)});var k=function(c){var m=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=m-this.data.player_init_time),this.pageLoadInitTime=this.data.page_load_init_time||this.pageLoadInitTime,this.pageLoadEndTime=this.data.page_load_end_time||this.pageLoadEndTime,!this.mux.PLAYER_TRACKED&&this.pageLoadInitTime&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.pageLoadEndTime)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.pageLoadEndTime||1/0)-this.pageLoadInitTime)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return o.one("playerready",k),o.longResumeTracker=new Fr(b(o)),o.errorTracker=new Ft(b(o)),new Zt(b(o)),o.seekingTracker=new Yt(b(o)),o.playheadTime=new Wt(b(o)),o.playbackHeartbeat=new Ut(b(o)),new Kt(b(o)),o.watchTimeTracker=new Vt(b(o)),new jt(b(o)),o.adTracker=new $t(b(o)),new Qt(b(o)),new Jt(b(o)),new zt(b(o)),new Ur(b(o)),new jr(b(o)),new Wr(b(o)),n.hlsjs&&o.addHLSJS(n),n.dashjs&&o.addDashJS(n),o.emit("viewinit",n.data),o}return N(t,[{key:"emit",value:function(a,n){var o,s=Object.assign({viewer_time:this.mux.utils.now()},n),u=[a,s];if(this.emitTranslator)try{u=this.emitTranslator(a,s)}catch(f){this.mux.log.warn("Exception in emit translator callback.",f)}u!=null&&u.length&&(o=De(X(t.prototype),"emit",this)).call.apply(o,[this].concat(V(u)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start!="undefined"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(a){if(this.data.view_id){var n=Object.assign({},this.data),o=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(n.video_source_is_live===void 0&&(n.player_source_duration===1/0||n.video_source_duration===1/0?n.video_source_is_live=!0:(n.player_source_duration>0||n.video_source_duration>0)&&(n.video_source_is_live=!1)),n.video_source_is_live||o.forEach(function(g){n[g]=void 0}),n.video_source_url=n.video_source_url||n.player_source_url,n.video_source_url){var s=H(re(n.video_source_url),2),u=s[0],f=s[1];n.video_source_domain=f,n.video_source_hostname=u}delete n.ad_request_id,this.playbackEventDispatcher.send(a,n),this.data.view_sequence_number++,this.data.player_sequence_number++,Di.has(a)||this._restartHeartBeat(),a==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(a){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",a)}},{key:"_updateStateData",value:function(){var a,n=this.getStateData();if(typeof this.stateDataTranslator=="function")try{n=this.stateDataTranslator(n)}catch(u){this.mux.log.warn("Exception in stateDataTranslator translator callback.",u)}if(!((a=this.data)===null||a===void 0)&&a.video_cdn&&(n!=null&&n.video_cdn)){var o=n.video_cdn,s=qt(n,["video_cdn"]);n=s}Object.assign(this.data,n),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var a=this,n=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];n.forEach(function(s){var u=parseInt(a.data[s],10);a.data[s]=isNaN(u)?void 0:u});var o=["player_source_url","video_source_url"];o.forEach(function(s){if(a.data[s]){var u=a.data[s].toLowerCase();(u.indexOf("data:")===0||u.indexOf("blob:")===0)&&(a.data[s]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var a=this;Object.keys(this.data).forEach(function(n){n.indexOf("video_")===0&&delete a.data[n]})}},{key:"_resetViewData",value:function(){var a=this;Object.keys(this.data).forEach(function(n){n.indexOf("view_")===0&&delete a.data[n]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var a=this,n=this.data.view_id=ee(),o=function(){n===a.data.view_id&&P(a.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",o):o()}},{key:"_restartHeartBeat",value:function(){var a=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){a.data.player_is_paused||a.emit("hb")},1e4)}},{key:"addHLSJS",value:function(a){if(!a.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=a.hlsjs,It(this.mux,this.id,a.hlsjs,{},a.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(Lt(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(a){if(!a.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=a.dashjs,Ct(this.mux,this.id,a.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(Mt(this.dashjs),this.dashjs=void 0)}}]),t}(Bt),Gr=Si;var he=G(nt());function ot(){return he.default&&!!(he.default.fullscreenElement||he.default.webkitFullscreenElement||he.default.mozFullScreenElement||he.default.msFullscreenElement)}var qi=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],Ri={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function st(r,e,t){var i=H(se(e),3),a=i[0],n=i[1],o=i[2],s=r.log,u=r.utils.getComputedStyle,f=r.utils.secondsToMs,g={automaticErrorTracking:!0};if(a){if(o!=="video"&&o!=="audio")return s.error("The element of `"+n+"` was not a media element.")}else return s.error("No element was found with the `"+n+"` query selector.");a.mux&&(a.mux.destroy(),delete a.mux,s.warn("Already monitoring this video element, replacing existing event listeners"));var k={getPlayheadTime:function(){return f(a.currentTime)},getStateData:function(){var m,w,x,v=((m=(w=this).getPlayheadTime)===null||m===void 0?void 0:m.call(w))||f(a.currentTime),p=this.hlsjs&&this.hlsjs.url,_=this.dashjs&&typeof this.dashjs.getSource=="function"&&this.dashjs.getSource(),d={player_is_paused:a.paused,player_width:parseInt(u(a,"width")),player_height:parseInt(u(a,"height")),player_autoplay_on:a.autoplay,player_preload_on:a.preload,player_language_code:a.lang,player_is_fullscreen:ot(),video_poster_url:a.poster,video_source_url:p||_||a.currentSrc,video_source_duration:f(a.duration),video_source_height:a.videoHeight,video_source_width:a.videoWidth,view_dropped_frame_count:a==null||(x=a.getVideoPlaybackQuality)===null||x===void 0?void 0:x.call(a).droppedVideoFrames};if(a.getStartDate&&v>0){var y=a.getStartDate();if(y&&typeof y.getTime=="function"&&y.getTime()){var T=y.getTime();if(d.player_program_time=T+v,a.seekable.length>0){var E=T+a.seekable.end(a.seekable.length-1);d.player_live_edge_program_time=E}}}return d}};t=Object.assign(g,t,k),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:r.VERSION},t.data),a.mux=a.mux||{},a.mux.deleted=!1,a.mux.emit=function(c,m){r.emit(n,c,m)},a.mux.updateData=function(c){a.mux.emit("hb",c)};var h=function(){s.error("The monitor for this video element has already been destroyed.")};a.mux.destroy=function(){Object.keys(a.mux.listeners).forEach(function(c){a.removeEventListener(c,a.mux.listeners[c],!1)}),delete a.mux.listeners,a.mux.destroy=h,a.mux.swapElement=h,a.mux.emit=h,a.mux.addHLSJS=h,a.mux.addDashJS=h,a.mux.removeHLSJS=h,a.mux.removeDashJS=h,a.mux.updateData=h,a.mux.setEmitTranslator=h,a.mux.setStateDataTranslator=h,a.mux.setGetPlayheadTime=h,a.mux.deleted=!0,r.emit(n,"destroy")},a.mux.swapElement=function(c){var m=H(se(c),3),w=m[0],x=m[1],v=m[2];if(w){if(v!=="video"&&v!=="audio")return r.log.error("The element of `"+x+"` was not a media element.")}else return r.log.error("No element was found with the `"+x+"` query selector.");w.muxId=a.muxId,delete a.muxId,w.mux=w.mux||{},w.mux.listeners=Object.assign({},a.mux.listeners),delete a.mux.listeners,Object.keys(w.mux.listeners).forEach(function(p){a.removeEventListener(p,w.mux.listeners[p],!1),w.addEventListener(p,w.mux.listeners[p],!1)}),w.mux.swapElement=a.mux.swapElement,w.mux.destroy=a.mux.destroy,delete a.mux,a=w},a.mux.addHLSJS=function(c){r.addHLSJS(n,c)},a.mux.addDashJS=function(c){r.addDashJS(n,c)},a.mux.removeHLSJS=function(){r.removeHLSJS(n)},a.mux.removeDashJS=function(){r.removeDashJS(n)},a.mux.setEmitTranslator=function(c){r.setEmitTranslator(n,c)},a.mux.setStateDataTranslator=function(c){r.setStateDataTranslator(n,c)},a.mux.setGetPlayheadTime=function(c){c||(c=t.getPlayheadTime),r.setGetPlayheadTime(n,c)},r.init(n,t),r.emit(n,"playerready"),a.paused||(r.emit(n,"play"),a.readyState>2&&r.emit(n,"playing")),a.mux.listeners={},qi.forEach(function(c){c==="error"&&!t.automaticErrorTracking||(a.mux.listeners[c]=function(){var m={};if(c==="error"){if(!a.error||a.error.code===1)return;m.player_error_code=a.error.code,m.player_error_message=Ri[a.error.code]||a.error.message}r.emit(n,c,m)},a.addEventListener(c,a.mux.listeners[c],!1))})}function ut(r,e,t,i){var a=i;if(r&&typeof r[e]=="function")try{a=r[e].apply(r,t)}catch(n){R.info("safeCall error",n)}return a}var ge=G(Q()),ye;ge.default&&ge.default.WeakMap&&(ye=new WeakMap);function dt(r,e){if(!r||!e||!ge.default||typeof ge.default.getComputedStyle!="function")return"";var t;return ye&&ye.has(r)&&(t=ye.get(r)),t||(t=ge.default.getComputedStyle(r,null),ye&&ye.set(r,t)),t.getPropertyValue(e)}function lt(r){return Math.floor(r*1e3)}var le={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},Ve=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};Ve.prototype.process=function(r){var e;for(this.buffer+=r,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};Ve.prototype.processLine=function(r){var e=r.indexOf(":"),t=Ii(r,e),i=t[0],a=t.length===2?_t(t[1]):void 0;if(i[0]!=="#")this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case le.TARGET_DURATION:{if(!isFinite(a)||a<0)return;this.manifest.targetDuration=a,this.setHoldBack();break}case le.PART_INF:{ct(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case le.SERVER_CONTROL:{ct(this.manifest,t),this.setHoldBack();break}case le.INF:{a===0?this.currentUri.duration=.01:a>0&&(this.currentUri.duration=a);break}case le.PROGRAM_DATE_TIME:{var n=a,o=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=o),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=o;break}case le.VERSION:{ct(this.manifest,t);break}case le.SESSION_DATA:{var s=Li(t[1]),u=Me(s);Object.assign(this.manifest.sessionData,u)}}};Ve.prototype.setHoldBack=function(){var r=this.manifest,e=r.serverControl,t=r.targetDuration,i=r.partTargetDuration;if(e){var a="holdBack",n="partHoldBack",o=t&&t*3,s=i&&i*2;t&&!e.hasOwnProperty(a)&&(e[a]=o),o&&e[a]<o&&(e[a]=o),i&&!e.hasOwnProperty(n)&&(e[n]=i*3),i&&e[n]<s&&(e[n]=s)}};var ct=function(r,e){var t=Jr(e[0].replace("#EXT-X-","")),i;Oi(e[1])?(i={},i=Object.assign(Pi(e[1]),i)):i=_t(e[1]),r[t]=i},Jr=function(r){return r.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},_t=function(r){if(r.toLowerCase()==="yes"||r.toLowerCase()==="no")return r.toLowerCase()==="yes";var e=r.indexOf(":")!==-1?r:parseFloat(r);return isNaN(e)?r:e},Ai=function(r){var e={},t=r.split("=");if(t.length>1){var i=Jr(t[0]);e[i]=_t(t[1])}return e},Pi=function(r){for(var e=r.split(","),t={},i=0;e.length>i;i++){var a=e[i],n=Ai(a);t=Object.assign(n,t)}return t},Oi=function(r){return r.indexOf("=")>-1},Ii=function(r,e){return e===-1?[r]:[r.substring(0,e),r.substring(e+1)]},Li=function(r){var e={};if(r){var t=r.search(","),i=r.slice(0,t),a=r.slice(t+1),n=[i,a];return n.forEach(function(o,s){for(var u=o.replace(/['"]+/g,"").split("="),f=0;f<u.length;f++)u[f]==="DATA-ID"&&(e["DATA-ID"]=u[1-f]),u[f]==="VALUE"&&(e.VALUE=u[1-f])}),{data:e}}},Qr=Ve;var Ni={safeCall:ut,safeIncrement:P,getComputedStyle:dt,secondsToMs:lt,assign:Object.assign,headersStringToObject:pe,cdnHeadersToRequestId:de,extractHostnameAndDomain:re,extractHostname:F,manifestParser:Qr,generateShortID:Oe,generateUUID:ee,now:A.now,findMediaElement:se},zr=Ni;var Ci={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",PLAYBACK_MODE_CHANGE:"playbackmodechange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},Kr=Ci;var Mi="mux-embed",Hi="5.13.0",Bi="2.1",C={},ne=function(e){var t=arguments;typeof e=="string"?ne.hasOwnProperty(e)?be.default.setTimeout(function(){t=Array.prototype.splice.call(t,1),ne[e].apply(null,t)},0):R.warn("`"+e+"` is an unknown task"):typeof e=="function"?be.default.setTimeout(function(){e(ne)},0):R.warn("`"+e+"` is invalid.")},Ui={loaded:A.now(),NAME:Mi,VERSION:Hi,API_VERSION:Bi,PLAYER_TRACKED:!1,monitor:function(e,t){return st(ne,e,t)},destroyMonitor:function(e){var t=H(se(e),1),i=t[0];i&&i.mux&&typeof i.mux.destroy=="function"?i.mux.destroy():R.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var i=J(e);C[i]?C[i].addHLSJS(t):R.error("A monitor for `"+i+"` has not been initialized.")},addDashJS:function(e,t){var i=J(e);C[i]?C[i].addDashJS(t):R.error("A monitor for `"+i+"` has not been initialized.")},removeHLSJS:function(e){var t=J(e);C[t]?C[t].removeHLSJS():R.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=J(e);C[t]?C[t].removeDashJS():R.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){ce()&&t&&t.respectDoNotTrack&&R.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var i=J(e);C[i]=new Gr(ne,i,t)},emit:function(e,t,i){var a=J(e);C[a]?(C[a].emit(t,i),t==="destroy"&&delete C[a]):R.error("A monitor for `"+a+"` has not been initialized.")},updateData:function(e,t){var i=J(e);C[i]?C[i].emit("hb",t):R.error("A monitor for `"+i+"` has not been initialized.")},setEmitTranslator:function(e,t){var i=J(e);C[i]?C[i].emitTranslator=t:R.error("A monitor for `"+i+"` has not been initialized.")},setStateDataTranslator:function(e,t){var i=J(e);C[i]?C[i].stateDataTranslator=t:R.error("A monitor for `"+i+"` has not been initialized.")},setGetPlayheadTime:function(e,t){var i=J(e);C[i]?C[i].getPlayheadTime=t:R.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:ce,log:R,utils:zr,events:Kr,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(ne,Ui);typeof be.default!="undefined"&&typeof be.default.addEventListener=="function"&&be.default.addEventListener("pagehide",function(r){r.persisted||(ne.WINDOW_UNLOADING=!0)},!1);var Fi=ne;
/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/
