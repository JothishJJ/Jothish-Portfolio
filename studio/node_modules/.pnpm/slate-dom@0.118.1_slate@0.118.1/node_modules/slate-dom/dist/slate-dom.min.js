!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("slate")):"function"==typeof define&&define.amd?define(["exports","slate"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).SlateDom={},t.Slate)}(this,(function(t,e){"use strict";function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var o=n((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n},t.exports.__esModule=!0,t.exports.default=t.exports}));r(o);var a=n((function(t){t.exports=function(t){if(Array.isArray(t))return o(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));r(a);var i=n((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));r(i);var l=n((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}));r(l);var s=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}));r(s);var f=r(n((function(t){t.exports=function(t){return a(t)||i(t)||l(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports}))),d=n((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports}));r(d);var u=n((function(t){t.exports=function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,f=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(t){f=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(f)throw o}}return l}},t.exports.__esModule=!0,t.exports.default=t.exports}));r(u);var c=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}));r(c);var h=r(n((function(t){t.exports=function(t,e){return d(t)||u(t,e)||l(t,e)||c()},t.exports.__esModule=!0,t.exports.default=t.exports})));function p(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw a}}}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var v,m,y=globalThis.Node,w=globalThis.Element,b=globalThis.Text,x=globalThis.Range,E=globalThis.Selection,O=globalThis.StaticRange,S=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||null},D=function(t){return M(t)&&1===t.nodeType},M=function(t){var e=S(t);return!!e&&t instanceof e.Node},_=function(t){var e=t&&t.anchorNode&&S(t.anchorNode);return!!e&&t instanceof e.Selection},k=function(t){return M(t)&&3===t.nodeType},T=function(t){var e=h(t,2),r=e[0],n=e[1];if(D(r)&&r.childNodes.length){var o=n===r.childNodes.length,a=o?n-1:n,i=P(r,a,o?"backward":"forward"),l=h(i,2);for(r=l[0],o=(a=l[1])<n;D(r)&&r.childNodes.length;){var s=o?r.childNodes.length-1:0;r=N(r,s,o?"backward":"forward")}n=o&&null!=r.textContent?r.textContent.length:0}return[r,n]},C=function(t){for(var e=t&&t.parentNode;e;){if("[object ShadowRoot]"===e.toString())return!0;e=e.parentNode}return!1},P=function(t,e,r){for(var n,o=t.childNodes,a=o[e],i=e,l=!1,s=!1;(M(n=a)&&8===n.nodeType||D(a)&&0===a.childNodes.length||D(a)&&"false"===a.getAttribute("contenteditable"))&&(!l||!s);)i>=o.length?(l=!0,i=e-1,r="backward"):i<0?(s=!0,i=e+1,r="forward"):(a=o[i],e=i,i+="forward"===r?1:-1);return[a,e]},N=function(t,e,r){var n=P(t,e,r);return h(n,1)[0]},A=function t(e){var r="";if(k(e)&&e.nodeValue)return e.nodeValue;if(D(e)){for(var n=0,o=Array.from(e.childNodes);n<o.length;n++){r+=t(o[n])}var a=getComputedStyle(e).getPropertyValue("display");"block"!==a&&"list"!==a&&"BR"!==e.tagName||(r+="\n")}return r},R=/data-slate-fragment="(.+?)"/m,I=function(t){var e=t.getData("text/html").match(R)||[];return h(e,2)[1]},W=function(t){return null!=t.getSelection?t.getSelection():document.getSelection()},B=function(t,e){return Boolean(t.compareDocumentPosition(e)&y.DOCUMENT_POSITION_PRECEDING)},F=function(t,e){return Boolean(t.compareDocumentPosition(e)&y.DOCUMENT_POSITION_FOLLOWING)},j="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,L="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),H="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent),K="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),U="undefined"!=typeof navigator&&/AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent),q="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])(?:\.)/i.test(navigator.userAgent),z="undefined"!=typeof navigator&&/Chrome/i.test(navigator.userAgent),V="undefined"!=typeof navigator&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])(?:\.)/i.test(navigator.userAgent),G=H&&"undefined"!=typeof navigator&&/Chrome?\/(?:[0-5]?\d)(?:\.)/i.test(navigator.userAgent),Y="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])(?:\.)).*/i.test(navigator.userAgent),X="undefined"!=typeof navigator&&/.*UCBrowser/.test(navigator.userAgent),$="undefined"!=typeof navigator&&/.*Wechat/.test(navigator.userAgent)&&!/.*MacWechat/.test(navigator.userAgent)&&(!z||V),J=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement);"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&/Version\/(\d+)/.test(navigator.userAgent)&&null!==(v=navigator.userAgent.match(/Version\/(\d+)/))&&void 0!==v&&v[1]&&parseInt(null===(m=navigator.userAgent.match(/Version\/(\d+)/))||void 0===m?void 0:m[1],10);var Q=(!V||!G)&&!q&&"undefined"!=typeof globalThis&&globalThis.InputEvent&&"function"==typeof globalThis.InputEvent.prototype.getTargetRanges,Z=n((function(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));r(Z);var tt=n((function(t){var e=Z.default;t.exports=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));r(tt);var et=n((function(t){var e=Z.default;t.exports=function(t){var r=tt(t,"string");return"symbol"===e(r)?r:String(r)},t.exports.__esModule=!0,t.exports.default=t.exports}));r(et);var rt=r(n((function(t){function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,et(n.key),n)}}t.exports=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}))),nt=r(n((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}))),ot=r(n((function(t){t.exports=function(t,e,r){return(e=et(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.__esModule=!0,t.exports.default=t.exports}))),at=0,it=rt((function t(){nt(this,t),ot(this,"id",void 0),this.id="".concat(at++)})),lt=new WeakMap,st=new WeakMap,ft=new WeakMap,dt=new WeakMap,ut=new WeakMap,ct=new WeakMap,ht=new WeakMap,pt=new WeakMap,gt=new WeakMap,vt=new WeakMap,mt=new WeakMap,yt=new WeakMap,wt=new WeakMap,bt=new WeakMap,xt=new WeakMap,Et=new WeakMap,Ot=new WeakMap,St=new WeakMap,Dt=new WeakMap,Mt=new WeakMap,_t=new WeakMap,kt=new WeakMap,Tt=Symbol("placeholder"),Ct=Symbol("mark-placeholder"),Pt={androidPendingDiffs:function(t){return Dt.get(t)},androidScheduleFlush:function(t){var e;null===(e=Et.get(t))||void 0===e||e()},blur:function(t){var e=Pt.toDOMNode(t,t),r=Pt.findDocumentOrShadowRoot(t);yt.set(t,!1),r.activeElement===e&&e.blur()},deselect:function(t){var r=t.selection,n=Pt.findDocumentOrShadowRoot(t),o=W(n);o&&o.rangeCount>0&&o.removeAllRanges(),r&&e.Transforms.deselect(t)},findDocumentOrShadowRoot:function(t){var e=Pt.toDOMNode(t,t),r=e.getRootNode();return r instanceof Document||r instanceof ShadowRoot?r:e.ownerDocument},findEventRange:function(t,r){"nativeEvent"in r&&(r=r.nativeEvent);var n=r,o=n.clientX,a=n.clientY,i=n.target;if(null==o||null==a)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(r));var l,s=Pt.toSlateNode(t,r.target),f=Pt.findPath(t,s);if(e.Element.isElement(s)&&e.Editor.isVoid(t,s)){var d=i.getBoundingClientRect(),u=t.isInline(s)?o-d.left<d.left+d.width-o:a-d.top<d.top+d.height-a,c=e.Editor.point(t,f,{edge:u?"start":"end"}),h=u?e.Editor.before(t,c):e.Editor.after(t,c);if(h)return e.Editor.range(t,h)}var p=Pt.getWindow(t).document;if(p.caretRangeFromPoint)l=p.caretRangeFromPoint(o,a);else{var g=p.caretPositionFromPoint(o,a);g&&((l=p.createRange()).setStart(g.offsetNode,g.offset),l.setEnd(g.offsetNode,g.offset))}if(!l)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(r));return Pt.toSlateRange(t,l,{exactMatch:!1,suppressThrow:!1})},findKey:function(t,e){var r=gt.get(e);return r||(r=new it,gt.set(e,r)),r},findPath:function(t,r){for(var n=[],o=r;;){var a=ft.get(o);if(null==a){if(e.Editor.isEditor(o))return n;break}var i=st.get(o);if(null==i)break;n.unshift(i),o=a}throw new Error("Unable to find the path for Slate node: ".concat(e.Scrubber.stringify(r)))},focus:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{retries:5};if(!yt.get(t)&&ut.get(t)){if(r.retries<=0)throw new Error("Could not set focus, editor seems stuck with pending operations");if(t.operations.length>0)setTimeout((function(){Pt.focus(t,{retries:r.retries-1})}),10);else{var n=Pt.toDOMNode(t,t),o=Pt.findDocumentOrShadowRoot(t);if(o.activeElement!==n){if(t.selection&&o instanceof Document){var a=W(o),i=Pt.toDOMRange(t,t.selection);null==a||a.removeAllRanges(),null==a||a.addRange(i)}t.selection||e.Transforms.select(t,e.Editor.start(t,[])),yt.set(t,!0),n.focus({preventScroll:!0})}}}},getWindow:function(t){var e=dt.get(t);if(!e)throw new Error("Unable to find a host window element for this editor");return e},hasDOMNode:function(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.editable,a=void 0!==o&&o,i=Pt.toDOMNode(t,t);try{r=D(e)?e:e.parentElement}catch(t){if(t instanceof Error&&!t.message.includes('Permission denied to access property "nodeType"'))throw t}return!!r&&!(r.closest("[data-slate-editor]")!==i||a&&!r.isContentEditable&&("boolean"!=typeof r.isContentEditable||r.closest('[contenteditable="false"]')!==i)&&!r.getAttribute("data-slate-zero-width"))},hasEditableTarget:function(t,e){return M(e)&&Pt.hasDOMNode(t,e,{editable:!0})},hasRange:function(t,r){var n=r.anchor,o=r.focus;return e.Editor.hasPath(t,n.path)&&e.Editor.hasPath(t,o.path)},hasSelectableTarget:function(t,e){return Pt.hasEditableTarget(t,e)||Pt.isTargetInsideNonReadonlyVoid(t,e)},hasTarget:function(t,e){return M(e)&&Pt.hasDOMNode(t,e)},insertData:function(t,e){t.insertData(e)},insertFragmentData:function(t,e){return t.insertFragmentData(e)},insertTextData:function(t,e){return t.insertTextData(e)},isComposing:function(t){return!!wt.get(t)},isFocused:function(t){return!!yt.get(t)},isReadOnly:function(t){return!!mt.get(t)},isTargetInsideNonReadonlyVoid:function(t,r){if(mt.get(t))return!1;var n=Pt.hasTarget(t,r)&&Pt.toSlateNode(t,r);return e.Element.isElement(n)&&e.Editor.isVoid(t,n)},setFragmentData:function(t,e,r){return t.setFragmentData(e,r)},toDOMNode:function(t,r){var n=vt.get(t),o=e.Editor.isEditor(r)?ut.get(t):null==n?void 0:n.get(Pt.findKey(t,r));if(!o)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(e.Scrubber.stringify(r)));return o},toDOMPoint:function(t,r){var n,o=e.Editor.node(t,r.path),a=h(o,1)[0],i=Pt.toDOMNode(t,a);e.Editor.void(t,{at:r})&&(r={path:r.path,offset:0});for(var l=Array.from(i.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),s=0,f=0;f<l.length;f++){var d=l[f],u=d.childNodes[0];if(null!=u&&null!=u.textContent){var c=u.textContent.length,p=d.getAttribute("data-slate-length"),g=s+(null==p?c:parseInt(p,10)),v=l[f+1];if(r.offset===g&&null!=v&&v.hasAttribute("data-slate-mark-placeholder")){var m,y=v.childNodes[0];n=[y instanceof b?y:v,null!==(m=v.textContent)&&void 0!==m&&m.startsWith("\ufeff")?1:0];break}if(r.offset<=g){n=[u,Math.min(c,Math.max(0,r.offset-s))];break}s=g}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(e.Scrubber.stringify(r)));return n},toDOMRange:function(t,r){var n=r.anchor,o=r.focus,a=e.Range.isBackward(r),i=Pt.toDOMPoint(t,n),l=e.Range.isCollapsed(r)?i:Pt.toDOMPoint(t,o),s=Pt.getWindow(t).document.createRange(),f=h(a?l:i,2),d=f[0],u=f[1],c=h(a?i:l,2),p=c[0],g=c[1],v=!!(D(d)?d:d.parentElement).getAttribute("data-slate-zero-width"),m=!!(D(p)?p:p.parentElement).getAttribute("data-slate-zero-width");return s.setStart(d,v?1:u),s.setEnd(p,m?1:g),s},toSlateNode:function(t,e){var r=D(e)?e:e.parentElement;r&&!r.hasAttribute("data-slate-node")&&(r=r.closest("[data-slate-node]"));var n=r?ht.get(r):null;if(!n)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(r));return n},toSlatePoint:function(t,r,n){var o=n.exactMatch,a=n.suppressThrow,i=n.searchDirection,l=o?r:T(r),s=h(l,2),d=s[0],u=s[1],c=d.parentNode,p=null,g=0;if(c){var v,m,y=Pt.toDOMNode(t,t),w=c.closest('[data-slate-void="true"]'),b=w&&y.contains(w)?w:null,x=c.closest('[contenteditable="false"]'),E=x&&y.contains(x)?x:null,O=c.closest("[data-slate-leaf]"),S=null;if(O){if(p=O.closest('[data-slate-node="text"]')){var D=Pt.getWindow(t).document.createRange();D.setStart(p,0),D.setEnd(d,u);var M=D.cloneContents();[].concat(f(Array.prototype.slice.call(M.querySelectorAll("[data-slate-zero-width]"))),f(Array.prototype.slice.call(M.querySelectorAll("[contenteditable=false]")))).forEach((function(t){H&&!o&&t.hasAttribute("data-slate-zero-width")&&t.textContent.length>0&&"\ufeff"!==t.textContext?t.textContent.startsWith("\ufeff")&&(t.textContent=t.textContent.slice(1)):t.parentNode.removeChild(t)})),g=M.textContent.length,S=p}}else if(b){for(var _=b.querySelectorAll("[data-slate-leaf]"),k=0;k<_.length;k++){var C=_[k];if(Pt.hasDOMNode(t,C)){O=C;break}}O?(p=O.closest('[data-slate-node="text"]'),g=(S=O).textContent.length,S.querySelectorAll("[data-slate-zero-width]").forEach((function(t){g-=t.textContent.length}))):g=1}else if(E){var P,N,A=function(t){return t?t.querySelectorAll("[data-slate-leaf]:not(:scope [data-slate-editor] [data-slate-leaf])"):[]},R=E.closest('[data-slate-node="element"]');if("backward"===i||!i)O=null!==(P=[].concat(f(A(null==R?void 0:R.previousElementSibling)),f(A(R))).findLast((function(t){return B(E,t)})))&&void 0!==P?P:null;if("forward"===i||!i)O=null!==(N=[].concat(f(A(R)),f(A(null==R?void 0:R.nextElementSibling))).find((function(t){return F(E,t)})))&&void 0!==N?N:null;O&&(p=O.closest('[data-slate-node="text"]'),S=O,"forward"===i?g=0:(g=S.textContent.length,S.querySelectorAll("[data-slate-zero-width]").forEach((function(t){g-=t.textContent.length}))))}S&&g===S.textContent.length&&H&&"z"===S.getAttribute("data-slate-zero-width")&&null!==(v=S.textContent)&&void 0!==v&&v.startsWith("\ufeff")&&(c.hasAttribute("data-slate-zero-width")||K&&null!==(m=S.textContent)&&void 0!==m&&m.endsWith("\n\n"))&&g--}if(H&&!p&&!o){var I=c.hasAttribute("data-slate-node")?c:c.closest("[data-slate-node]");if(I&&Pt.hasDOMNode(t,I,{editable:!0})){var W=Pt.toSlateNode(t,I),j=e.Editor.start(t,Pt.findPath(t,W)),L=j.path,U=j.offset;return I.querySelector("[data-slate-leaf]")||(U=u),{path:L,offset:U}}}if(!p){if(a)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(r))}var q=Pt.toSlateNode(t,p);return{path:Pt.findPath(t,q),offset:g}},toSlateRange:function(t,r,n){var o,a,i,l,s,f,d=n.exactMatch,u=n.suppressThrow;if(_(r)?r.anchorNode:r.startContainer)if(_(r)){if(K&&r.rangeCount>1){l=r.focusNode;var c=r.getRangeAt(0),h=r.getRangeAt(r.rangeCount-1);if(l instanceof HTMLTableRowElement&&c.startContainer instanceof HTMLTableRowElement&&h.startContainer instanceof HTMLTableRowElement){var p=function t(e){return e.childElementCount>0?t(e.children[0]):e},g=c.startContainer,v=h.startContainer,m=p(g.children[c.startOffset]),y=p(v.children[h.startOffset]);s=0,a=y.childNodes.length>0?y.childNodes[0]:y,l=m.childNodes.length>0?m.childNodes[0]:m,i=y instanceof HTMLElement?y.innerHTML.length:0}else c.startContainer===l?(a=h.endContainer,i=h.endOffset,s=c.startOffset):(a=c.startContainer,i=c.endOffset,s=h.startOffset)}else a=r.anchorNode,i=r.anchorOffset,l=r.focusNode,s=r.focusOffset;f=z&&C(a)||K?r.anchorNode===r.focusNode&&r.anchorOffset===r.focusOffset:r.isCollapsed}else a=r.startContainer,i=r.startOffset,l=r.endContainer,s=r.endOffset,f=r.collapsed;if(null==a||null==l||null==i||null==s)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(r));K&&null!==(o=l.textContent)&&void 0!==o&&o.endsWith("\n\n")&&s===l.textContent.length&&s--;var w=Pt.toSlatePoint(t,[a,i],{exactMatch:d,suppressThrow:u});if(!w)return null;var b=B(a,l)||a===l&&s<i,x=f?w:Pt.toSlatePoint(t,[l,s],{exactMatch:d,suppressThrow:u,searchDirection:b?"forward":"backward"});if(!x)return null;var E={anchor:w,focus:x};return e.Range.isExpanded(E)&&e.Range.isForward(E)&&D(l)&&e.Editor.void(t,{at:E.focus,mode:"highest"})&&(E=e.Editor.unhangRange(t,E,{voids:!0})),E}};function Nt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.reduce((function(t,e){return t.slice(0,e.start)+e.text+t.slice(e.end)}),t)}function At(t,e){var r=e.start,n=e.end,o=e.text,a=t.slice(r,n),i=function(t,e){for(var r=Math.min(t.length,e.length),n=0;n<r;n++)if(t.charAt(n)!==e.charAt(n))return n;return r}(a,o),l=function(t,e,r){for(var n=Math.min(t.length,e.length,r),o=0;o<n;o++)if(t.charAt(t.length-o-1)!==e.charAt(e.length-o-1))return o;return n}(a,o,Math.min(a.length-i,o.length-i)),s={start:r+i,end:n-l,text:o.slice(i,o.length-l)};return s.start===s.end&&0===s.text.length?null:s}function Rt(t,r){var n=r.path,o=r.offset;if(!e.Editor.hasPath(t,n))return null;var a=e.Node.get(t,n);if(!e.Text.isText(a))return null;var i=e.Editor.above(t,{match:function(r){return e.Element.isElement(r)&&e.Editor.isBlock(t,r)},at:n});if(!i)return null;for(;o>a.text.length;){var l=e.Editor.next(t,{at:n,match:e.Text.isText});if(!l||!e.Path.isDescendant(l[1],i[1]))return null;o-=a.text.length,a=l[0],n=l[1]}return{path:n,offset:o}}function It(t,r,n){var o=Dt.get(t),a=null==o?void 0:o.find((function(t){var n=t.path;return e.Path.equals(n,r.path)}));if(!a||r.offset<=a.diff.start)return e.Point.transform(r,n,{affinity:"backward"});var i=a.diff;if(r.offset<=i.start+i.text.length){var l={path:r.path,offset:i.start},s=e.Point.transform(l,n,{affinity:"backward"});return s?{path:s.path,offset:s.offset+r.offset-i.start}:null}var f={path:r.path,offset:r.offset-i.text.length+i.end-i.start},d=e.Point.transform(f,n,{affinity:"backward"});return d?"split_node"===n.type&&e.Path.equals(n.path,r.path)&&f.offset<n.position&&i.start<n.position?d:{path:d.path,offset:d.offset+i.text.length-i.end+i.start}:null}function Wt(t,r,n){var o=It(t,r.anchor,n);if(!o)return null;if(e.Range.isCollapsed(r))return{anchor:o,focus:o};var a=It(t,r.focus,n);return a?{anchor:o,focus:a}:null}function Bt(t,r){var n=t.path,o=t.diff,a=t.id;switch(r.type){case"insert_text":return!e.Path.equals(r.path,n)||r.offset>=o.end?t:r.offset<=o.start?{diff:{start:r.text.length+o.start,end:r.text.length+o.end,text:o.text},id:a,path:n}:{diff:{start:o.start,end:o.end+r.text.length,text:o.text},id:a,path:n};case"remove_text":return!e.Path.equals(r.path,n)||r.offset>=o.end?t:r.offset+r.text.length<=o.start?{diff:{start:o.start-r.text.length,end:o.end-r.text.length,text:o.text},id:a,path:n}:{diff:{start:o.start,end:o.end-r.text.length,text:o.text},id:a,path:n};case"split_node":return!e.Path.equals(r.path,n)||r.position>=o.end?{diff:o,id:a,path:e.Path.transform(n,r,{affinity:"backward"})}:r.position>o.start?{diff:{start:o.start,end:Math.min(r.position,o.end),text:o.text},id:a,path:n}:{diff:{start:o.start-r.position,end:o.end-r.position,text:o.text},id:a,path:e.Path.transform(n,r,{affinity:"forward"})};case"merge_node":return e.Path.equals(r.path,n)?{diff:{start:o.start+r.position,end:o.end+r.position,text:o.text},id:a,path:e.Path.transform(n,r)}:{diff:o,id:a,path:e.Path.transform(n,r)}}var i=e.Path.transform(n,r);return i?{diff:o,path:i,id:a}:null}var Ft=function(t,e){var r=(e.top+e.bottom)/2;return t.top<=r&&t.bottom>=r},jt=function(t,e,r){var n=Pt.toDOMRange(t,e).getBoundingClientRect(),o=Pt.toDOMRange(t,r).getBoundingClientRect();return Ft(n,o)&&Ft(o,n)},Lt=function(t,r){var n=e.Editor.range(t,e.Range.end(r)),o=Array.from(e.Editor.positions(t,{at:r})),a=0,i=o.length,l=Math.floor(i/2);if(jt(t,e.Editor.range(t,o[a]),n))return e.Editor.range(t,o[a],n);if(o.length<2)return e.Editor.range(t,o[o.length-1],n);for(;l!==o.length&&l!==a;)jt(t,e.Editor.range(t,o[l]),n)?i=l:a=l,l=Math.floor((a+i)/2);return e.Editor.range(t,o[a],n)};function Ht(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Kt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kt(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw a}}}}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function qt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(r),!0).forEach((function(e){ot(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ut(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var zt=function(t,r){var n,o=[],a=Ht(e.Editor.levels(t,{at:r}));try{for(a.s();!(n=a.n()).done;){var i=h(n.value,2),l=i[0],s=i[1],f=Pt.findKey(t,l);o.push([s,f])}}catch(t){a.e(t)}finally{a.f()}return o},Vt=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});for(var r="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),n={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},o={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:r?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},a={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=1;i<20;i++)a["f"+i]=111+i;function l(t,e,r){e&&!("byKey"in e)&&(r=e,e=null),Array.isArray(t)||(t=[t]);var n=t.map((function(t){return s(t,e)})),o=function(t){return n.some((function(e){return f(e,t)}))};return null==r?o:o(r)}function s(t,e){var r=e&&e.byKey,i={},l=(t=t.replace("++","+add")).split("+"),s=l.length;for(var f in n)i[n[f]]=!1;var c=!0,h=!1,p=void 0;try{for(var g,v=l[Symbol.iterator]();!(c=(g=v.next()).done);c=!0){var m=g.value,y=m.endsWith("?")&&m.length>1;y&&(m=m.slice(0,-1));var w=u(m),b=n[w];if(m.length>1&&!b&&!o[m]&&!a[w])throw new TypeError('Unknown modifier: "'+m+'"');1!==s&&b||(r?i.key=w:i.which=d(m)),b&&(i[b]=!y||null)}}catch(t){h=!0,p=t}finally{try{!c&&v.return&&v.return()}finally{if(h)throw p}}return i}function f(t,e){for(var r in t){var n=t[r],o=void 0;if(null!=n&&((null!=(o="key"===r&&null!=e.key?e.key.toLowerCase():"which"===r?91===n&&93===e.which?91:e.which:e[r])||!1!==n)&&o!==n))return!1}return!0}function d(t){return t=u(t),a[t]||t.toUpperCase().charCodeAt(0)}function u(t){return t=t.toLowerCase(),t=o[t]||t}e.default=l,e.isHotkey=l,e.isCodeHotkey=function(t,e){return l(t,e)},e.isKeyHotkey=function(t,e){return l(t,{byKey:!0},e)},e.parseHotkey=s,e.compareHotkey=f,e.toKeyCode=d,e.toKeyName=u}));r(Vt);var Gt=Vt.isHotkey;Vt.isCodeHotkey,Vt.isKeyHotkey,Vt.parseHotkey,Vt.compareHotkey,Vt.toKeyCode,Vt.toKeyName;var Yt={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},Xt={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},$t={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},Jt=function(t){var e=Yt[t],r=Xt[t],n=$t[t],o=e&&Gt(e),a=r&&Gt(r),i=n&&Gt(n);return function(t){return!(!o||!o(t))||(!!(L&&a&&a(t))||!(L||!i||!i(t)))}},Qt={isBold:Jt("bold"),isCompose:Jt("compose"),isMoveBackward:Jt("moveBackward"),isMoveForward:Jt("moveForward"),isDeleteBackward:Jt("deleteBackward"),isDeleteForward:Jt("deleteForward"),isDeleteLineBackward:Jt("deleteLineBackward"),isDeleteLineForward:Jt("deleteLineForward"),isDeleteWordBackward:Jt("deleteWordBackward"),isDeleteWordForward:Jt("deleteWordForward"),isExtendBackward:Jt("extendBackward"),isExtendForward:Jt("extendForward"),isExtendLineBackward:Jt("extendLineBackward"),isExtendLineForward:Jt("extendLineForward"),isItalic:Jt("italic"),isMoveLineBackward:Jt("moveLineBackward"),isMoveLineForward:Jt("moveLineForward"),isMoveWordBackward:Jt("moveWordBackward"),isMoveWordForward:Jt("moveWordForward"),isRedo:Jt("redo"),isSoftBreak:Jt("insertSoftBreak"),isSplitBlock:Jt("splitBlock"),isTransposeCharacter:Jt("transposeCharacter"),isUndo:Jt("undo")},Zt=n((function(t){t.exports=function(t,e){if(null==t)return{};var r,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||(o[r]=t[r]);return o},t.exports.__esModule=!0,t.exports.default=t.exports}));r(Zt);var te=r(n((function(t){t.exports=function(t,e){if(null==t)return{};var r,n,o=Zt(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o},t.exports.__esModule=!0,t.exports.default=t.exports}))),ee=["anchor","focus"],re=["anchor","focus"];function ne(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ne(Object(r),!0).forEach((function(e){ot(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ae(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return ie(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ie(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){l=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw a}}}}function ie(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var le=function(t,e){t.anchor,t.focus;var r=te(t,ee);e.anchor,e.focus;var n,o,a=te(e,re);return t[Tt]===e[Tt]&&(n=r,o=a,Object.keys(n).length===Object.keys(o).length&&Object.keys(n).every((function(t){return o.hasOwnProperty(t)&&n[t]===o[t]})))};t.CAN_USE_DOM=J,t.DOMEditor=Pt,t.DOMElement=w,t.DOMNode=y,t.DOMRange=x,t.DOMSelection=E,t.DOMStaticRange=O,t.DOMText=b,t.EDITOR_TO_ELEMENT=ut,t.EDITOR_TO_FORCE_RENDER=kt,t.EDITOR_TO_KEY_TO_ELEMENT=vt,t.EDITOR_TO_ON_CHANGE=xt,t.EDITOR_TO_PENDING_ACTION=Mt,t.EDITOR_TO_PENDING_DIFFS=Dt,t.EDITOR_TO_PENDING_INSERTION_MARKS=Ot,t.EDITOR_TO_PENDING_SELECTION=_t,t.EDITOR_TO_PLACEHOLDER_ELEMENT=ct,t.EDITOR_TO_SCHEDULE_FLUSH=Et,t.EDITOR_TO_USER_MARKS=St,t.EDITOR_TO_USER_SELECTION=bt,t.EDITOR_TO_WINDOW=dt,t.ELEMENT_TO_NODE=ht,t.HAS_BEFORE_INPUT_SUPPORT=Q,t.Hotkeys=Qt,t.IS_ANDROID=H,t.IS_CHROME=z,t.IS_COMPOSING=wt,t.IS_FIREFOX=K,t.IS_FIREFOX_LEGACY=Y,t.IS_FOCUSED=yt,t.IS_IOS=j,t.IS_NODE_MAP_DIRTY=lt,t.IS_READ_ONLY=mt,t.IS_UC_MOBILE=X,t.IS_WEBKIT=U,t.IS_WECHATBROWSER=$,t.Key=it,t.MARK_PLACEHOLDER_SYMBOL=Ct,t.NODE_TO_ELEMENT=pt,t.NODE_TO_INDEX=st,t.NODE_TO_KEY=gt,t.NODE_TO_PARENT=ft,t.PLACEHOLDER_SYMBOL=Tt,t.TRIPLE_CLICK=3,t.applyStringDiff=Nt,t.getActiveElement=function(){for(var t=document.activeElement;null!==(e=t)&&void 0!==e&&e.shadowRoot&&null!==(r=t.shadowRoot)&&void 0!==r&&r.activeElement;){var e,r,n;t=null===(n=t)||void 0===n||null===(n=n.shadowRoot)||void 0===n?void 0:n.activeElement}return t},t.getDefaultView=S,t.getSelection=W,t.hasShadowRoot=C,t.isAfter=F,t.isBefore=B,t.isDOMElement=D,t.isDOMNode=M,t.isDOMSelection=_,t.isElementDecorationsEqual=function(t,r){if(t===r)return!0;if(!t||!r)return!1;if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++){var o=t[n],a=r[n];if(!e.Range.equals(o,a)||!le(o,a))return!1}return!0},t.isPlainTextOnlyPaste=function(t){return t.clipboardData&&""!==t.clipboardData.getData("text/plain")&&1===t.clipboardData.types.length},t.isTextDecorationsEqual=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++){var n=t[r],o=e[r];if(n.anchor.offset!==o.anchor.offset||n.focus.offset!==o.focus.offset||!le(n,o))return!1}return!0},t.isTrackedMutation=function t(e,r,n){var o=r.target;if(D(o)&&o.matches('[contentEditable="false"]'))return!1;if(Pt.getWindow(e).document.contains(o))return Pt.hasDOMNode(e,o,{editable:!0});var a=n.find((function(t){var e,r=t.addedNodes,n=t.removedNodes,a=p(r);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i===o||i.contains(o))return!0}}catch(t){a.e(t)}finally{a.f()}var l,s=p(n);try{for(s.s();!(l=s.n()).done;){var f=l.value;if(f===o||f.contains(o))return!0}}catch(t){s.e(t)}finally{s.f()}}));return!(!a||a===r)&&t(e,a,n)},t.mergeStringDiffs=function(t,e,r){var n=Math.min(e.start,r.start),o=Math.max(0,Math.min(e.start+e.text.length,r.end)-r.start),a=Nt(t,e,r),i=Math.max(r.start+r.text.length,e.start+e.text.length+(e.start+e.text.length>r.start?r.text.length:0)-o),l=a.slice(n,i);return At(t,{start:n,end:Math.max(e.end,r.end-e.text.length+(e.end-e.start)),text:l})},t.normalizeDOMPoint=T,t.normalizePoint=Rt,t.normalizeRange=function(t,r){var n=Rt(t,r.anchor);if(!n)return null;if(e.Range.isCollapsed(r))return{anchor:n,focus:n};var o=Rt(t,r.focus);return o?{anchor:n,focus:o}:null},t.normalizeStringDiff=At,t.splitDecorationsByChild=function(t,r,n){var o=Array.from(r.children,(function(){return[]}));if(0===n.length)return o;var a,i=Pt.findPath(t,r),l=i.length,s=e.Editor.range(t,i),d=new Array(r.children.length),u=function(r){var n=d[r];if(n)return n;var o=e.Editor.range(t,[].concat(f(i),[r]));return d[r]=o,o},c=ae(n);try{for(c.s();!(a=c.n()).done;){var p=a.value,g=e.Range.intersection(s,p);if(g)for(var v=e.Range.edges(g),m=h(v,2),y=m[0],w=m[1],b=y.path[l],x=w.path[l],E=b;E<=x;E++){var O=o[E];if(O){var S=u(E),D=e.Range.intersection(S,p);D&&O.push(oe(oe({},p),D))}}}}catch(t){c.e(t)}finally{c.f()}return o},t.targetRange=function(t){var e=t.path,r=t.diff;return{anchor:{path:e,offset:r.start},focus:{path:e,offset:r.end}}},t.verifyDiffState=function(t,r){var n=r.path,o=r.diff;if(!e.Editor.hasPath(t,n))return!1;var a=e.Node.get(t,n);if(!e.Text.isText(a))return!1;if(o.start!==a.text.length||0===o.text.length)return a.text.slice(o.start,o.start+o.text.length)===o.text;var i=e.Path.next(n);if(!e.Editor.hasPath(t,i))return!1;var l=e.Node.get(t,i);return e.Text.isText(l)&&l.text.startsWith(o.text)},t.withDOM=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x-slate-fragment",n=t,o=n.apply,a=n.onChange,i=n.deleteBackward,l=n.addMark,s=n.removeMark;return vt.set(n,new WeakMap),n.addMark=function(t,e){var r,o;null===(r=Et.get(n))||void 0===r||r(),!Ot.get(n)&&null!==(o=Dt.get(n))&&void 0!==o&&o.length&&Ot.set(n,null),St.delete(n),l(t,e)},n.removeMark=function(t){var e;!Ot.get(n)&&null!==(e=Dt.get(n))&&void 0!==e&&e.length&&Ot.set(n,null),St.delete(n),s(t)},n.deleteBackward=function(t){if("line"!==t)return i(t);if(n.selection&&e.Range.isCollapsed(n.selection)){var r=e.Editor.above(n,{match:function(t){return e.Element.isElement(t)&&e.Editor.isBlock(n,t)},at:n.selection});if(r){var o=h(r,2)[1],a=e.Editor.range(n,o,n.selection.anchor),l=Lt(n,a);e.Range.isCollapsed(l)||e.Transforms.delete(n,{at:l})}}},n.apply=function(r){var a=[],i=[],l=Dt.get(n);if(null!=l&&l.length){var s=l.map((function(t){return Bt(t,r)})).filter(Boolean);Dt.set(n,s)}var d=_t.get(n);d&&_t.set(n,Wt(n,d,r));var u=Mt.get(n);if(null!=u&&u.at){var c=e.Point.isPoint(null==u?void 0:u.at)?It(n,u.at,r):Wt(n,u.at,r);Mt.set(n,c?qt(qt({},u),{},{at:c}):null)}switch(r.type){case"insert_text":case"remove_text":case"set_node":case"split_node":a.push.apply(a,f(zt(n,r.path)));break;case"set_selection":var p;null===(p=bt.get(n))||void 0===p||p.unref(),bt.delete(n);break;case"insert_node":case"remove_node":a.push.apply(a,f(zt(n,e.Path.parent(r.path))));break;case"merge_node":var g=e.Path.previous(r.path);a.push.apply(a,f(zt(n,g)));break;case"move_node":var v,m=e.Path.common(e.Path.parent(r.path),e.Path.parent(r.newPath));a.push.apply(a,f(zt(n,m))),e.Path.isBefore(r.path,r.newPath)?(a.push.apply(a,f(zt(n,e.Path.parent(r.path)))),v=r.newPath):(a.push.apply(a,f(zt(n,e.Path.parent(r.newPath)))),v=r.path);var y=e.Node.get(t,e.Path.parent(v)),w=Pt.findKey(n,y),b=e.Editor.pathRef(n,e.Path.parent(v));i.push([b,w])}switch(o(r),r.type){case"insert_node":case"remove_node":case"merge_node":case"move_node":case"split_node":case"insert_text":case"remove_text":case"set_selection":lt.set(n,!0)}for(var x=0,E=a;x<E.length;x++){var O=h(E[x],2),S=O[0],D=O[1],M=e.Editor.node(n,S),_=h(M,1)[0];gt.set(_,D)}for(var k=0,T=i;k<T.length;k++){var C=h(T[k],2),P=C[0],N=C[1];if(P.current){var A=e.Editor.node(n,P.current),R=h(A,1)[0];gt.set(R,N)}P.unref()}},n.setFragmentData=function(t){var o=n.selection;if(o){var a=e.Range.edges(o),i=h(a,2),l=i[0],s=i[1],f=e.Editor.void(n,{at:l.path}),d=e.Editor.void(n,{at:s.path});if(!e.Range.isCollapsed(o)||f){var u=Pt.toDOMRange(n,o),c=u.cloneContents(),p=c.childNodes[0];if(c.childNodes.forEach((function(t){t.textContent&&""!==t.textContent.trim()&&(p=t)})),d){var g=h(d,1)[0],v=u.cloneRange(),m=Pt.toDOMNode(n,g);v.setEndAfter(m),c=v.cloneContents()}if(f&&(p=c.querySelector("[data-slate-spacer]")),Array.from(c.querySelectorAll("[data-slate-zero-width]")).forEach((function(t){var e="n"===t.getAttribute("data-slate-zero-width");t.textContent=e?"\n":""})),k(p)){var y=p.ownerDocument.createElement("span");y.style.whiteSpace="pre",y.appendChild(p),c.appendChild(y),p=y}var w=n.getFragment(),b=JSON.stringify(w),x=window.btoa(encodeURIComponent(b));p.setAttribute("data-slate-fragment",x),t.setData("application/".concat(r),x);var E=c.ownerDocument.createElement("div");return E.appendChild(c),E.setAttribute("hidden","true"),c.ownerDocument.body.appendChild(E),t.setData("text/html",E.innerHTML),t.setData("text/plain",A(E)),c.ownerDocument.body.removeChild(E),t}}},n.insertData=function(t){n.insertFragmentData(t)||n.insertTextData(t)},n.insertFragmentData=function(t){var e=t.getData("application/".concat(r))||I(t);if(e){var o=decodeURIComponent(window.atob(e)),a=JSON.parse(o);return n.insertFragment(a),!0}return!1},n.insertTextData=function(t){var r=t.getData("text/plain");if(r){var o,a=!1,i=Ht(r.split(/\r\n|\r|\n/));try{for(i.s();!(o=i.n()).done;){var l=o.value;a&&e.Transforms.splitNodes(n,{always:!0}),n.insertText(l),a=!0}}catch(t){i.e(t)}finally{i.f()}return!0}return!1},n.onChange=function(t){var e=xt.get(n);e&&e(t),a(t)},n}}));
